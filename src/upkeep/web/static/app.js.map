{
  "version": 3,
  "sources": ["ts/modules/ui.ts", "ts/modules/dashboard.ts", "ts/modules/utils.ts", "ts/modules/operation-times.ts", "ts/modules/maintenance.ts", "ts/modules/storage.ts", "ts/modules/schedule.ts", "ts/app.ts"],
  "sourcesContent": ["/**\n * UI utilities: theme, notifications, loading, modals\n */\n\nimport type { ToastType, TabName } from '../types';\n\n// ============================================================================\n// Theme Management\n// ============================================================================\n\nexport function initTheme(): void {\n  const savedTheme = localStorage.getItem('theme') || 'system';\n  applyTheme(savedTheme);\n\n  // Listen for system theme changes when in system mode\n  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {\n    const currentTheme = localStorage.getItem('theme') || 'system';\n    if (currentTheme === 'system') {\n      applyTheme('system');\n    }\n  });\n}\n\nexport function toggleTheme(): void {\n  // Cycle through: light \u2192 dark \u2192 system \u2192 light\n  const currentTheme = localStorage.getItem('theme') || 'system';\n  let newTheme: string;\n\n  if (currentTheme === 'light') {\n    newTheme = 'dark';\n  } else if (currentTheme === 'dark') {\n    newTheme = 'system';\n  } else {\n    newTheme = 'light';\n  }\n\n  applyTheme(newTheme);\n  localStorage.setItem('theme', newTheme);\n}\n\nfunction applyTheme(theme: string): void {\n  // If system theme, detect browser preference\n  let actualTheme = theme;\n  if (theme === 'system') {\n    actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n  }\n\n  document.documentElement.setAttribute('data-theme', actualTheme);\n  const icon = document.getElementById('theme-icon');\n  if (icon) {\n    // Show icon based on theme mode\n    if (theme === 'light') {\n      icon.textContent = '\u2600\uFE0F';\n    } else if (theme === 'dark') {\n      icon.textContent = '\uD83C\uDF19';\n    } else {\n      icon.textContent = '\uD83D\uDDA5\uFE0F';  // System mode\n    }\n  }\n}\n\n// ============================================================================\n// Toast Notifications\n// ============================================================================\n\nexport function showToast(message: string, type: ToastType = 'info', duration: number = 3000): void {\n  const toast = document.createElement('div');\n  toast.className = `toast ${type}`;\n  toast.textContent = message;\n\n  const container = document.getElementById('toast-container');\n  if (!container) {\n    console.error('Toast container not found');\n    return;\n  }\n\n  container.appendChild(toast);\n\n  // Trigger animation\n  setTimeout(() => toast.classList.add('show'), 10);\n\n  // Auto-remove after duration\n  setTimeout(() => {\n    toast.classList.remove('show');\n    setTimeout(() => toast.remove(), 300);\n  }, duration);\n}\n\n// ============================================================================\n// Loading Indicator\n// ============================================================================\n\nexport function showLoading(message: string = 'Loading...'): void {\n  const loading = document.getElementById('loading-indicator');\n  const loadingMessage = document.getElementById('loading-message');\n  if (loading) {\n    loading.classList.add('active');\n    if (loadingMessage) {\n      loadingMessage.textContent = message;\n    }\n  }\n}\n\nexport function hideLoading(): void {\n  const loading = document.getElementById('loading-indicator');\n  if (loading) {\n    loading.classList.remove('active');\n  }\n}\n\n// ============================================================================\n// Progress Overlay Modal\n// ============================================================================\n\nlet progressOverlayActive = false;\nlet progressCancelCallback: (() => void) | null = null;\nlet progressStartTime: number | null = null;\n\nexport function showProgressOverlay(title: string, total: number, cancelCallback: () => void): void {\n  const overlay = document.getElementById('progress-overlay');\n  const titleEl = document.getElementById('progress-title');\n  const percentEl = document.getElementById('progress-percent');\n  const currentEl = document.getElementById('progress-current');\n  const barEl = document.getElementById('progress-bar');\n\n  if (!overlay || !titleEl || !percentEl || !currentEl || !barEl) {\n    console.error('Progress overlay elements not found');\n    return;\n  }\n\n  titleEl.textContent = title;\n  percentEl.textContent = '0%';\n  currentEl.textContent = '0';\n  const remainingEl = document.getElementById('progress-remaining');\n  if (remainingEl) {\n    remainingEl.textContent = '--';\n  }\n  barEl.style.width = '0%';\n\n  overlay.classList.add('active');\n  progressOverlayActive = true;\n  progressCancelCallback = cancelCallback;\n  progressStartTime = Date.now();\n\n  // ESC key to close\n  document.addEventListener('keydown', handleProgressEscape);\n}\n\nexport function updateProgressOverlay(current: number, total: number, message: string = ''): void {\n  if (!progressOverlayActive) return;\n\n  const percent = Math.round((current / total) * 100);\n  const percentEl = document.getElementById('progress-percent');\n  const currentEl = document.getElementById('progress-current');\n  const barEl = document.getElementById('progress-bar');\n  const remainingEl = document.getElementById('progress-remaining');\n  const messageEl = document.getElementById('progress-message');\n\n  if (!percentEl || !currentEl || !barEl) return;\n\n  // Animate values\n  const currentPercent = parseInt(percentEl.textContent || '0');\n  animateValue(percentEl, currentPercent, percent, 200, 0, '%');\n  currentEl.textContent = String(current);\n  barEl.style.width = percent + '%';\n\n  // Calculate time remaining\n  if (current > 0 && progressStartTime && remainingEl) {\n    const elapsed = (Date.now() - progressStartTime) / 1000; // seconds\n    const rate = current / elapsed; // items per second\n    const remaining = total - current;\n    const eta = remaining / rate; // seconds\n\n    if (eta < 60) {\n      remainingEl.textContent = Math.round(eta) + 's';\n    } else {\n      const minutes = Math.floor(eta / 60);\n      const seconds = Math.round(eta % 60);\n      remainingEl.textContent = `${minutes}m ${seconds}s`;\n    }\n  }\n\n  if (message && messageEl) {\n    messageEl.textContent = message;\n  }\n}\n\nexport function hideProgressOverlay(): void {\n  const overlay = document.getElementById('progress-overlay');\n  if (overlay) {\n    overlay.classList.remove('active');\n  }\n  progressOverlayActive = false;\n  progressCancelCallback = null;\n  progressStartTime = null;\n  document.removeEventListener('keydown', handleProgressEscape);\n}\n\nexport function cancelProgress(): void {\n  if (progressCancelCallback) {\n    progressCancelCallback();\n  }\n  hideProgressOverlay();\n  showToast('Operation cancelled', 'warning');\n}\n\nfunction handleProgressEscape(e: KeyboardEvent): void {\n  if (e.key === 'Escape' && progressOverlayActive) {\n    cancelProgress();\n  }\n}\n\n// ============================================================================\n// Value Animation\n// ============================================================================\n\n/**\n * Animate a number from old value to new value\n */\nexport function animateValue(\n  element: HTMLElement,\n  start: number,\n  end: number,\n  duration: number = 300,\n  decimals: number = 1,\n  suffix: string = ''\n): void {\n  const startTime = performance.now();\n  const delta = end - start;\n\n  function update(currentTime: number): void {\n    const elapsed = currentTime - startTime;\n    const progress = Math.min(elapsed / duration, 1);\n\n    // Ease-out cubic\n    const easeProgress = 1 - Math.pow(1 - progress, 3);\n    const current = start + (delta * easeProgress);\n\n    element.textContent = current.toFixed(decimals) + suffix;\n\n    if (progress < 1) {\n      requestAnimationFrame(update);\n    }\n  }\n\n  requestAnimationFrame(update);\n}\n\n// ============================================================================\n// System Configuration\n// ============================================================================\n\nexport async function reloadScripts(): Promise<void> {\n  const btn = document.getElementById('reload-scripts-btn') as HTMLButtonElement;\n  const statusEl = document.getElementById('reload-scripts-status');\n\n  if (!btn || !statusEl) return;\n\n  // Disable button and show loading state\n  btn.disabled = true;\n  btn.textContent = '\u23F3 Reloading...';\n  statusEl.textContent = 'Copying updated scripts to system location...';\n  statusEl.style.color = 'var(--text-secondary)';\n\n  try {\n    const response = await fetch('/api/system/reload-scripts', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' }\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to reload scripts');\n    }\n\n    const result = await response.json();\n\n    // Success\n    btn.textContent = '\u2713 Reloaded';\n    statusEl.textContent = result.message || 'Scripts reloaded successfully. Changes will take effect immediately.';\n    statusEl.style.color = 'var(--success)';\n    showToast('Scripts reloaded successfully', 'success');\n\n    // Reset button after 3 seconds\n    setTimeout(() => {\n      btn.disabled = false;\n      btn.textContent = '\uD83D\uDD04 Reload Scripts';\n      statusEl.textContent = '';\n    }, 3000);\n\n  } catch (error) {\n    // Error\n    const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n    btn.textContent = '\u2717 Failed';\n    statusEl.textContent = `Error: ${errorMessage}`;\n    statusEl.style.color = 'var(--danger)';\n    showToast(`Failed to reload scripts: ${errorMessage}`, 'error');\n\n    // Reset button after 5 seconds\n    setTimeout(() => {\n      btn.disabled = false;\n      btn.textContent = '\uD83D\uDD04 Reload Scripts';\n    }, 5000);\n  }\n}\n\n// ============================================================================\n// Tab Switching\n// ============================================================================\n\nexport function switchTab(tabName: TabName): void {\n  document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));\n  document.querySelectorAll('.tabs button').forEach(btn => btn.classList.remove('active'));\n\n  const tabContent = document.getElementById(tabName);\n  if (tabContent) {\n    tabContent.classList.add('active');\n  }\n\n  // Find and activate the corresponding tab button\n  const tabButtons = document.querySelectorAll('.tabs button');\n  tabButtons.forEach(btn => {\n    if (btn.textContent?.toLowerCase().includes(tabName)) {\n      btn.classList.add('active');\n    }\n  });\n\n  // Load data for the tab\n  if (tabName === 'dashboard') {\n    // Load dashboard data\n    const loadSystemInfo = (window as any).loadSystemInfo;\n    if (loadSystemInfo) loadSystemInfo();\n  } else if (tabName === 'maintenance') {\n    // Load operations\n    const loadOperations = (window as any).loadOperations;\n    if (loadOperations) loadOperations();\n  } else if (tabName === 'schedule') {\n    // Initialize schedule tab\n    const onScheduleTabShow = (window as any).onScheduleTabShow;\n    if (onScheduleTabShow) onScheduleTabShow();\n  }\n}\n", "/**\n * Dashboard module - System monitoring and health display\n */\n\nimport type { SystemInfoData, SparklineData, PreviousMetrics, ProcessInfo } from '../types';\nimport { showToast } from './ui';\nimport { animateValue } from './ui';\n\n// ============================================================================\n// Global State\n// ============================================================================\n\nexport const sparklineData: SparklineData = {\n  cpu: [],\n  memory: [],\n  disk: [],\n  timestamps: []\n};\n\nexport const previousMetrics: PreviousMetrics = {\n  cpu: null,\n  memory: null,\n  disk: null\n};\n\nexport let currentUsername: string | null = null;\n\n// ============================================================================\n// System Metrics & Health\n// ============================================================================\n\n/**\n * Load and display system information\n */\nexport async function loadSystemInfo(): Promise<void> {\n  try {\n    const response = await fetch('/api/system/info');\n    const data: SystemInfoData = await response.json();\n\n    // Store username globally for use in path buttons\n    if (data.system && data.system.username) {\n      currentUsername = data.system.username;\n      // Also store on window for access from other modules\n      (window as any)._currentUsername = data.system.username;\n    }\n\n    // Calculate trends\n    const cpuTrend = calculateTrend(data.cpu.history);\n    const memoryTrend = calculateTrend(data.memory.history);\n    const diskTrend = calculateTrend(data.disk.history);\n\n    // System metrics with animations\n    const metricsDiv = document.getElementById('system-metrics');\n    if (!metricsDiv) return;\n\n    const isFirstLoad = previousMetrics.cpu === null;\n\n    if (isFirstLoad) {\n      // First load: build HTML structure\n      metricsDiv.innerHTML = `\n        <div class=\"metric-card\">\n          <h3>CPU Usage</h3>\n          <div class=\"value\" id=\"cpu-value\">${data.cpu.percent.toFixed(1)}%</div>\n          ${getTrendHTML(cpuTrend, data.cpu.history)}\n          <div class=\"sparkline-container\">\n            <canvas id=\"cpu-sparkline\" class=\"sparkline\" width=\"80\" height=\"24\"></canvas>\n          </div>\n          <div class=\"subvalue\">${data.cpu.count} cores</div>\n          <div class=\"progress-bar\">\n            <div class=\"progress-bar-fill ${getStatusClass(data.cpu.percent)}\" id=\"cpu-bar\"\n                 style=\"width: ${data.cpu.percent}%\"></div>\n          </div>\n        </div>\n        <div class=\"metric-card\">\n          <h3>Memory</h3>\n          <div class=\"value\" id=\"memory-value\">${data.memory.percent.toFixed(1)}%</div>\n          ${getTrendHTML(memoryTrend, data.memory.history)}\n          <div class=\"sparkline-container\">\n            <canvas id=\"memory-sparkline\" class=\"sparkline\" width=\"80\" height=\"24\"></canvas>\n          </div>\n          <div class=\"subvalue\">${data.memory.available_gb.toFixed(1)} GB available</div>\n          <div class=\"progress-bar\">\n            <div class=\"progress-bar-fill ${getStatusClass(data.memory.percent)}\" id=\"memory-bar\"\n                 style=\"width: ${data.memory.percent}%\"></div>\n          </div>\n        </div>\n        <div class=\"metric-card\">\n          <h3>Disk Space</h3>\n          <div class=\"value\" id=\"disk-value\">${data.disk.percent.toFixed(1)}%</div>\n          ${getTrendHTML(diskTrend, data.disk.history)}\n          <div class=\"sparkline-container\">\n            <canvas id=\"disk-sparkline\" class=\"sparkline\" width=\"80\" height=\"24\"></canvas>\n          </div>\n          <div class=\"subvalue\">${data.disk.free_gb.toFixed(1)} GB free of ${data.disk.total_gb.toFixed(1)} GB</div>\n          <div class=\"progress-bar\">\n            <div class=\"progress-bar-fill ${getStatusClass(data.disk.percent)}\" id=\"disk-bar\"\n                 style=\"width: ${data.disk.percent}%\"></div>\n          </div>\n        </div>\n        ${data.network ? `\n        <div class=\"metric-card\">\n          <h3>Network</h3>\n          <div class=\"value\" id=\"network-value\">\n            \u2193 ${data.network.download_mbps.toFixed(2)} MB/s\n          </div>\n          <div class=\"subvalue\" style=\"margin-top: 0.25rem;\">\n            \u2191 ${data.network.upload_mbps.toFixed(2)} MB/s\n          </div>\n          <div class=\"subvalue\" style=\"font-size: 0.75rem; margin-top: 0.5rem;\">\n            Total: \u2193${data.network.total_recv_gb} GB / \u2191${data.network.total_sent_gb} GB\n          </div>\n        </div>\n        ` : ''}\n        ${data.swap && data.swap.total_gb > 0 ? `\n        <div class=\"metric-card\">\n          <h3>Swap</h3>\n          <div class=\"value\" id=\"swap-value\">${data.swap.percent.toFixed(1)}%</div>\n          <div class=\"subvalue\">${data.swap.used_gb} GB used of ${data.swap.total_gb} GB</div>\n          <div class=\"progress-bar\">\n            <div class=\"progress-bar-fill ${getStatusClass(data.swap.percent)}\" id=\"swap-bar\"\n                 style=\"width: ${data.swap.percent}%\"></div>\n          </div>\n          ${data.swap.percent > 50 ? '<div class=\"warning\">\u26A0\uFE0F High swap usage indicates memory pressure</div>' : ''}\n        </div>\n        ` : ''}\n      `;\n\n      console.log('First load - Memory bar HTML rendered');\n      setTimeout(() => {\n        const memBar = document.getElementById('memory-bar');\n        if (memBar) {\n          console.log('Memory bar found after first load:', {\n            width: memBar.style.width,\n            className: memBar.className,\n            computedWidth: window.getComputedStyle(memBar).width,\n            parent: memBar.parentElement\n          });\n        } else {\n          console.error('Memory bar NOT found after first load!');\n        }\n      }, 100);\n    } else {\n      // Subsequent loads: animate values\n      const cpuValueEl = document.getElementById('cpu-value');\n      const memoryValueEl = document.getElementById('memory-value');\n      const diskValueEl = document.getElementById('disk-value');\n\n      if (cpuValueEl && previousMetrics.cpu !== null) {\n        animateValue(cpuValueEl, previousMetrics.cpu, data.cpu.percent, 300, 1, '%');\n      }\n      if (memoryValueEl && previousMetrics.memory !== null) {\n        animateValue(memoryValueEl, previousMetrics.memory, data.memory.percent, 300, 1, '%');\n      }\n      if (diskValueEl && previousMetrics.disk !== null) {\n        animateValue(diskValueEl, previousMetrics.disk, data.disk.percent, 300, 1, '%');\n      }\n\n      // Update progress bars smoothly\n      const cpuBar = document.getElementById('cpu-bar');\n      const memoryBar = document.getElementById('memory-bar');\n      const diskBar = document.getElementById('disk-bar');\n\n      if (!memoryBar) {\n        console.error('Memory bar element not found!');\n      } else {\n        console.log(`Memory bar found: width=${data.memory.percent}%, element:`, memoryBar);\n      }\n\n      if (cpuBar) {\n        cpuBar.style.width = data.cpu.percent + '%';\n        cpuBar.className = `progress-bar-fill ${getStatusClass(data.cpu.percent)}`;\n      }\n      if (memoryBar) {\n        memoryBar.style.width = data.memory.percent + '%';\n        memoryBar.className = `progress-bar-fill ${getStatusClass(data.memory.percent)}`;\n      }\n      if (diskBar) {\n        diskBar.style.width = data.disk.percent + '%';\n        diskBar.className = `progress-bar-fill ${getStatusClass(data.disk.percent)}`;\n      }\n\n      // Update trend indicators (recreate HTML for simplicity)\n      const cpuCard = document.querySelector('.metric-card:nth-child(1)');\n      const memoryCard = document.querySelector('.metric-card:nth-child(2)');\n      const diskCard = document.querySelector('.metric-card:nth-child(3)');\n\n      if (cpuCard) {\n        const existingTrend = cpuCard.querySelector('.trend');\n        if (existingTrend) existingTrend.remove();\n        const valueDiv = cpuCard.querySelector('.value');\n        if (valueDiv) {\n          valueDiv.insertAdjacentHTML('afterend', getTrendHTML(cpuTrend, data.cpu.history));\n        }\n      }\n      if (memoryCard) {\n        const existingTrend = memoryCard.querySelector('.trend');\n        if (existingTrend) existingTrend.remove();\n        const valueDiv = memoryCard.querySelector('.value');\n        if (valueDiv) {\n          valueDiv.insertAdjacentHTML('afterend', getTrendHTML(memoryTrend, data.memory.history));\n        }\n      }\n      if (diskCard) {\n        const existingTrend = diskCard.querySelector('.trend');\n        if (existingTrend) existingTrend.remove();\n        const valueDiv = diskCard.querySelector('.value');\n        if (valueDiv) {\n          valueDiv.insertAdjacentHTML('afterend', getTrendHTML(diskTrend, data.disk.history));\n        }\n      }\n    }\n\n    // Store current metrics for next animation\n    previousMetrics.cpu = data.cpu.percent;\n    previousMetrics.memory = data.memory.percent;\n    previousMetrics.disk = data.disk.percent;\n\n    // Fetch full sparkline data and draw\n    fetch('/api/system/sparkline')\n      .then(res => res.json())\n      .then(sparkData => {\n        console.log('Sparkline data received:', sparkData);\n        if (sparkData && sparkData.cpu && sparkData.cpu.length >= 2) {\n          drawSparkline('cpu-sparkline', sparkData.cpu, '#ff6961');\n          drawSparkline('memory-sparkline', sparkData.memory, '#0a84ff');\n          drawSparkline('disk-sparkline', sparkData.disk, '#ff9500');\n        } else {\n          console.warn('Sparkline data insufficient:', sparkData);\n        }\n      })\n      .catch(err => console.error('Error loading sparkline data:', err));\n\n    // System info\n    const systemInfoDiv = document.getElementById('system-info');\n    if (systemInfoDiv) {\n      systemInfoDiv.innerHTML = `\n        <dl class=\"info-item\">\n          <dt>Total Memory</dt>\n          <dd>${data.memory.total_gb.toFixed(1)} GB</dd>\n        </dl>\n        <dl class=\"info-item\">\n          <dt>Used Memory</dt>\n          <dd>${data.memory.used_gb.toFixed(1)} GB</dd>\n        </dl>\n        <dl class=\"info-item\">\n          <dt>Total Disk</dt>\n          <dd>${data.disk.total_gb.toFixed(1)} GB</dd>\n        </dl>\n        <dl class=\"info-item\">\n          <dt>Used Disk</dt>\n          <dd>${data.disk.used_gb.toFixed(1)} GB</dd>\n        </dl>\n      `;\n    }\n\n    // Maintenance status - Load last run time from API\n    const diskWarning = data.disk.percent > 80\n      ? `<div class=\"warning\">\u26A0\uFE0F Disk usage is high (${data.disk.percent.toFixed(1)}%). Consider running cleanup operations.</div>`\n      : '';\n    const memoryWarning = data.memory.percent > 80\n      ? `<div class=\"warning\">\u26A0\uFE0F Memory usage is high (${data.memory.percent.toFixed(1)}%).</div>`\n      : '';\n\n    // Fetch last maintenance run time\n    await loadLastMaintenanceRun(diskWarning, memoryWarning);\n\n  } catch (error) {\n    const metricsDiv = document.getElementById('system-metrics');\n    if (metricsDiv) {\n      metricsDiv.innerHTML = `<div class=\"error\">Error loading system info: ${(error as Error).message}</div>`;\n    }\n  }\n}\n\n/**\n * Load and display system health score\n */\nexport async function loadHealthScore(): Promise<void> {\n  const healthDiv = document.getElementById('health-score');\n  if (!healthDiv) return;\n\n  try {\n    const response = await fetch('/api/system/health');\n    const data = await response.json();\n\n    let issuesHTML = '';\n    if (data.issues && data.issues.length > 0) {\n      issuesHTML = `\n        <div class=\"health-issues\" style=\"margin-top: 1rem; text-align: left;\">\n          <h4 style=\"margin-bottom: 0.5rem;\">Issues Detected:</h4>\n          ${data.issues.map((issue: string) => `\n            <div class=\"warning\" style=\"margin-bottom: 0.5rem;\">\n              ${issue.includes('Critical') ? '\uD83D\uDD34' : '\u26A0\uFE0F'} ${issue}\n            </div>\n          `).join('')}\n        </div>\n      `;\n    }\n\n    healthDiv.innerHTML = `\n      <div class=\"health-score-value ${data.overall}\">\n        ${data.score}\n      </div>\n      <div class=\"health-status\">${data.overall.toUpperCase()}</div>\n      ${issuesHTML}\n    `;\n  } catch (error) {\n    healthDiv.innerHTML = `<div class=\"error\">Error loading health score: ${(error as Error).message}</div>`;\n  }\n}\n\n/**\n * Load and display top resource consumers\n */\nexport async function loadTopProcesses(): Promise<void> {\n  const processesDiv = document.getElementById('top-processes');\n  if (!processesDiv) return;\n\n  try {\n    const response = await fetch('/api/system/processes?limit=3');\n    const data = await response.json();\n\n    let html = '<div class=\"process-section\">';\n    html += '<h3 style=\"font-size: 0.875rem; margin-bottom: 0.5rem; color: var(--text-secondary);\">Top CPU Consumers</h3>';\n    html += '<div class=\"process-list\">';\n    data.top_cpu.forEach((proc: ProcessInfo, idx: number) => {\n      html += `\n        <div class=\"process-item\">\n          <div class=\"process-rank\">${idx + 1}</div>\n          <div class=\"process-name\">${proc.name}</div>\n          <div class=\"process-value\">${proc.cpu_percent}%</div>\n        </div>\n      `;\n    });\n    html += '</div></div>';\n\n    html += '<div class=\"process-section\" style=\"margin-top: 1.5rem;\">';\n    html += '<h3 style=\"font-size: 0.875rem; margin-bottom: 0.5rem; color: var(--text-secondary);\">Top Memory Consumers</h3>';\n    html += '<div class=\"process-list\">';\n    data.top_memory.forEach((proc: ProcessInfo, idx: number) => {\n      html += `\n        <div class=\"process-item\">\n          <div class=\"process-rank\">${idx + 1}</div>\n          <div class=\"process-name\">${proc.name}</div>\n          <div class=\"process-value\">${proc.memory_mb.toFixed(0)} MB</div>\n        </div>\n      `;\n    });\n    html += '</div></div>';\n\n    processesDiv.innerHTML = html;\n  } catch (error) {\n    processesDiv.innerHTML = `<div class=\"error\">Error loading processes: ${(error as Error).message}</div>`;\n  }\n}\n\n/**\n * Load and display last maintenance run time\n */\nexport async function loadLastMaintenanceRun(diskWarning: string = '', memoryWarning: string = ''): Promise<void> {\n  const statusDiv = document.getElementById('maintenance-status');\n  if (!statusDiv) return;\n\n  try {\n    const response = await fetch('/api/maintenance/last-run');\n    const data = await response.json();\n\n    let lastRunText: string;\n    if (data.status === 'never') {\n      lastRunText = '<strong>Never</strong>';\n    } else {\n      const lastRun = data.global_last_run || 'Unknown';\n      const relative = data.global_last_run_relative || '';\n      lastRunText = `<strong>${lastRun}</strong> <span style=\"color: var(--text-secondary);\">(${relative})</span>`;\n    }\n\n    statusDiv.innerHTML = `\n      <p>Last maintenance run: ${lastRunText}</p>\n      <p style=\"margin-top: 0.5rem;\">Recommendation: <strong>Run maintenance weekly</strong></p>\n      ${diskWarning}\n      ${memoryWarning}\n      ${!diskWarning && !memoryWarning ? '<div class=\"success\">\u2713 System is running smoothly</div>' : ''}\n    `;\n  } catch (error) {\n    // Fallback to \"Never\" if API fails\n    statusDiv.innerHTML = `\n      <p>Last maintenance run: <strong>Never</strong> <span style=\"color: var(--text-secondary);\">(check logs)</span></p>\n      <p style=\"margin-top: 0.5rem;\">Recommendation: <strong>Run maintenance weekly</strong></p>\n      ${diskWarning}\n      ${memoryWarning}\n      ${!diskWarning && !memoryWarning ? '<div class=\"success\">\u2713 System is running smoothly</div>' : ''}\n    `;\n  }\n}\n\n// ============================================================================\n// Sparkline & Trend Visualization\n// ============================================================================\n\n/**\n * Draw sparkline chart on canvas\n */\nexport function drawSparkline(canvasId: string, data: number[], color: string = '#0a84ff'): void {\n  const canvas = document.getElementById(canvasId) as HTMLCanvasElement | null;\n  if (!canvas) {\n    console.warn(`Canvas not found: ${canvasId}`);\n    return;\n  }\n  if (!data || data.length < 2) {\n    console.warn(`Insufficient data for ${canvasId}: ${data ? data.length : 0} points`);\n    return;\n  }\n\n  const ctx = canvas.getContext('2d');\n  if (!ctx) return;\n\n  const width = canvas.width;\n  const height = canvas.height;\n\n  // Clear canvas\n  ctx.clearRect(0, 0, width, height);\n\n  // Find min/max for scaling\n  const min = Math.min(...data);\n  const max = Math.max(...data);\n  const range = max - min || 1; // Avoid division by zero\n\n  // Draw line\n  ctx.beginPath();\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 1.5;\n  ctx.lineJoin = 'round';\n\n  data.forEach((value, index) => {\n    const x = (index / (data.length - 1)) * width;\n    const y = height - ((value - min) / range) * height;\n\n    if (index === 0) {\n      ctx.moveTo(x, y);\n    } else {\n      ctx.lineTo(x, y);\n    }\n  });\n\n  ctx.stroke();\n}\n\n/**\n * Calculate trend from history array\n */\nexport function calculateTrend(history: number[]): 'up' | 'down' | 'neutral' {\n  if (!history || history.length < 2) return 'neutral';\n\n  const recent = history[history.length - 1]!;\n  const previous = history[history.length - 2]!;\n  const delta = recent - previous;\n\n  if (Math.abs(delta) < 0.5) return 'neutral'; // Threshold for neutral\n  return delta > 0 ? 'up' : 'down';\n}\n\n/**\n * Get trend display HTML\n */\nexport function getTrendHTML(trend: 'up' | 'down' | 'neutral', history: number[]): string {\n  if (!history || history.length < 2) return '';\n\n  const recent = history[history.length - 1]!;\n  const previous = history[history.length - 2]!;\n  const delta = Math.abs(recent - previous).toFixed(1);\n\n  const arrows: Record<string, string> = {\n    up: '\u2191',\n    down: '\u2193',\n    neutral: '\u2022'\n  };\n\n  return `<span class=\"trend ${trend}\">${arrows[trend]} ${delta}%</span>`;\n}\n\n/**\n * Get status class based on percentage\n */\nexport function getStatusClass(percent: number): string {\n  if (percent > 90) return 'danger';\n  if (percent > 75) return 'warning';\n  return '';\n}\n", "/**\n * Utility functions for formatting and sanitization\n */\n\n/**\n * Format bytes to human-readable string\n */\nexport function formatBytes(bytes: number, decimals: number = 2): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];\n\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\n}\n\n/**\n * Format duration in seconds to human-readable string\n */\nexport function formatDuration(seconds: number): string {\n  if (seconds < 60) {\n    return `${seconds.toFixed(0)}s`;\n  } else if (seconds < 3600) {\n    const minutes = Math.floor(seconds / 60);\n    const secs = Math.round(seconds % 60);\n    return `${minutes}m ${secs}s`;\n  } else {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    return `${hours}h ${minutes}m`;\n  }\n}\n\n/**\n * Format time remaining\n */\nexport function formatTimeRemaining(seconds: number): string {\n  if (seconds < 60) {\n    return Math.round(seconds) + 's';\n  } else if (seconds < 3600) {\n    const minutes = Math.floor(seconds / 60);\n    const secs = Math.round(seconds % 60);\n    return `${minutes}m ${secs}s`;\n  } else {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    return `${hours}h ${minutes}m`;\n  }\n}\n\n/**\n * Escape HTML to prevent XSS\n * WARNING: Only use for element text content, not for attributes\n */\nexport function escapeHtml(str: string): string {\n  const div = document.createElement('div');\n  div.textContent = str;\n  return div.innerHTML;\n}\n\n/**\n * Handle search key events\n */\nexport function handleSearchKey(event: KeyboardEvent, searchInputId: string, searchFunction: () => void): void {\n  if (event.key === 'Enter') {\n    searchFunction();\n  } else if (event.key === 'Escape') {\n    const searchInput = document.getElementById(searchInputId) as HTMLInputElement;\n    if (searchInput) {\n      searchInput.value = '';\n      searchFunction();\n    }\n  }\n}\n", "/**\n * Operation Time Tracking\n *\n * Tracks historical execution times for maintenance operations\n * to provide accurate ETA calculations.\n */\n\ninterface OperationTimeData {\n  runs: number[];  // Last N run times in seconds\n  average: number; // Average of runs\n}\n\ninterface OperationTimesStorage {\n  [operationId: string]: OperationTimeData;\n}\n\nconst STORAGE_KEY = 'upkeep-operation-times';\nconst MAX_STORED_RUNS = 5;  // Keep last 5 runs for rolling average\nconst DEFAULT_DURATION = 30; // Default 30 seconds if no history\n\n/**\n * Load operation times from localStorage\n */\nexport function loadOperationTimes(): OperationTimesStorage {\n  try {\n    const data = localStorage.getItem(STORAGE_KEY);\n    if (!data) return {};\n    return JSON.parse(data);\n  } catch (error) {\n    console.error('Failed to load operation times:', error);\n    return {};\n  }\n}\n\n/**\n * Save operation times to localStorage\n */\nfunction saveOperationTimes(times: OperationTimesStorage): void {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(times));\n  } catch (error) {\n    console.error('Failed to save operation times:', error);\n  }\n}\n\n/**\n * Record operation duration\n */\nexport function recordOperationTime(operationId: string, durationSeconds: number): void {\n  const times = loadOperationTimes();\n\n  // Get existing data or create new\n  const data = times[operationId] || { runs: [], average: 0 };\n\n  // Add new duration\n  data.runs.push(Math.round(durationSeconds));\n\n  // Keep only last N runs\n  if (data.runs.length > MAX_STORED_RUNS) {\n    data.runs = data.runs.slice(-MAX_STORED_RUNS);\n  }\n\n  // Calculate average (round to 2 decimals for stable display/testing)\n  const avg = data.runs.reduce((sum, time) => sum + time, 0) / data.runs.length;\n  data.average = Math.round(avg * 100) / 100;\n\n  times[operationId] = data;\n  saveOperationTimes(times);\n}\n\n/**\n * Get average duration for an operation\n */\nexport function getAverageDuration(operationId: string): number {\n  const times = loadOperationTimes();\n  const data = times[operationId];\n\n  if (!data || data.runs.length === 0) {\n    return DEFAULT_DURATION;\n  }\n\n  return data.average;\n}\n\n/**\n * Get median duration for an operation (more resistant to outliers than average)\n */\nexport function getMedianDuration(operationId: string): number | null {\n  const times = loadOperationTimes();\n  const data = times[operationId];\n\n  if (!data || data.runs.length === 0) {\n    return null;  // No data available\n  }\n\n  // Sort runs to find median\n  const sorted = [...data.runs].sort((a, b) => a - b);\n  const mid = Math.floor(sorted.length / 2);\n\n  if (sorted.length % 2 === 0) {\n    // Even number: average of two middle values\n    const a = sorted[mid - 1];\n    const b = sorted[mid];\n    if (typeof a !== 'number' || typeof b !== 'number') return null;\n    return (a + b) / 2;\n  }\n\n  // Odd number: middle value\n  const m = sorted[mid];\n  return typeof m === 'number' ? m : null;\n}\n\n/**\n * Get formatted typical duration string for display\n * Returns null if no historical data exists\n */\nexport function getTypicalDurationDisplay(operationId: string): string | null {\n  const median = getMedianDuration(operationId);\n\n  if (median === null) {\n    return null;  // No data - don't show anything\n  }\n\n  // Format as human-readable duration\n  if (median < 60) {\n    return `${Math.round(median)}s`;\n  } else if (median < 3600) {\n    const minutes = Math.floor(median / 60);\n    const seconds = Math.round(median % 60);\n    return seconds > 0 ? `${minutes}m ${seconds}s` : `${minutes}m`;\n  } else {\n    const hours = Math.floor(median / 3600);\n    const minutes = Math.round((median % 3600) / 60);\n    return minutes > 0 ? `${hours}h ${minutes}m` : `${hours}h`;\n  }\n}\n\n/**\n * Calculate ETA for remaining operations\n */\nexport function calculateETA(\n  remainingOperationIds: string[],\n  currentOperationId: string | null,\n  currentOperationProgress: number\n): number {\n  let eta = 0;\n\n  // Add time for remaining operations (not yet started)\n  for (const opId of remainingOperationIds) {\n    eta += getAverageDuration(opId);\n  }\n\n  // Add remaining time for current operation\n  if (currentOperationId) {\n    const avgDuration = getAverageDuration(currentOperationId);\n\n    // Defensive: clamp progress to [0, 1] so weird UI states don't inflate ETA\n    const progress = Math.max(0, Math.min(1, currentOperationProgress));\n    const remainingProgress = 1 - progress;\n\n    eta += avgDuration * remainingProgress;\n  }\n\n  return Math.round(eta);\n}\n\n/**\n * Get historical data for an operation (for debugging/display)\n */\nexport function getOperationHistory(operationId: string): OperationTimeData | null {\n  const times = loadOperationTimes();\n  return times[operationId] || null;\n}\n\n/**\n * Clear all historical data (for testing/reset)\n */\nexport function clearOperationTimes(): void {\n  localStorage.removeItem(STORAGE_KEY);\n}\n", "/**\n * Maintenance module - Operations execution and progress tracking\n */\n\nimport type { MaintenanceOperation, OperationEvent } from '../types';\nimport { showToast } from './ui';\nimport { formatDuration } from './utils';\nimport { escapeHtml } from './utils';\nimport { recordOperationTime, calculateETA, getAverageDuration, getTypicalDurationDisplay, getMedianDuration } from './operation-times';\n\n// ============================================================================\n// Global State\n// ============================================================================\n\nexport let runningOperations = false;\nexport let operationInvocationId = 0; // Track which invocation is current (prevents race conditions)\nexport let allOperations: MaintenanceOperation[] = [];\n\n// Progress tracking\nexport let operationStartTime = 0;\nexport let batchStartTime = 0;  // Track when entire batch started\nexport let currentOperationIndex = 0;\nexport let totalOperations = 0;\nexport let operationTimes: number[] = [];\nexport let progressTimerInterval: number | null = null;\nexport let queueStatusInterval: number | null = null;\nexport let currentOperationId: string | null = null;\nexport let selectedOperationIds: string[] = [];  // Track which operations were selected\n\n// Per-operation stats from server (last run + typical runtime)\nlet operationStats: Record<string, any> = {};\n\n// ============================================================================\n// Load Operations\n// ============================================================================\n\n/**\n * Load and display available maintenance operations\n */\nexport async function loadOperations(): Promise<void> {\n  try {\n    // Add cache-busting parameter to force fresh data\n    const cacheBuster = Date.now();\n    const response = await fetch(`/api/maintenance/operations?_=${cacheBuster}`);\n    const data = await response.json();\n\n    if (!data.operations || data.operations.length === 0) {\n      const operationsDiv = document.getElementById('operations-list');\n      if (operationsDiv) {\n        operationsDiv.innerHTML = '<div class=\"error\">No operations available</div>';\n      }\n      return;\n    }\n\n    allOperations = data.operations;\n\n    // Sort by category\n    allOperations.sort((a, b) => {\n      if (a.category === b.category) {\n        return a.name.localeCompare(b.name);\n      }\n      return a.category.localeCompare(b.category);\n    });\n\n    // Fetch per-operation last run data\n    let operationsHistory: Record<string, any> = {};\n    try {\n      const lastRunResponse = await fetch('/api/maintenance/last-run');\n      const lastRunData = await lastRunResponse.json();\n      operationsHistory = lastRunData.operations || {};\n      operationStats = operationsHistory;\n    } catch (error) {\n      console.warn('Could not fetch per-operation history:', error);\n    }\n\n    // Run preflight checks (Doctor)\n    runDoctor().catch(() => {});\n\n    const html = allOperations.map(op => {\n      const opHistory = operationsHistory[op.id];\n\n      // Typical duration (server-provided preferred; fallback to localStorage)\n      const typicalDuration = opHistory?.typical_display || getTypicalDurationDisplay(op.id);\n      const durationHtml = typicalDuration\n        ? ` | \u23F1\uFE0F Typically <strong>${typicalDuration}</strong>`\n        : '';\n\n      let lastRunHtml = '';\n      if (opHistory && opHistory.last_run_relative) {\n        const statusIcon = opHistory.success ? '\u2713' : '\u2717';\n        const statusColor = opHistory.success ? 'var(--success-color)' : 'var(--error-color)';\n        lastRunHtml = `<div style=\"font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;\">\n          \uD83D\uDCC5 Last run: <strong>${opHistory.last_run_relative}</strong> <span style=\"color: ${statusColor}\">${statusIcon}</span>${durationHtml}\n        </div>`;\n      } else {\n        const typicalFallback = durationHtml || ' | \u23F1\uFE0F Typically <strong>\u2014</strong> <span style=\"opacity:0.7;\">(first run)</span>';\n        lastRunHtml = `<div style=\"font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;\">\n          \uD83D\uDCC5 Last run: <strong>Never run</strong>${durationHtml || typicalFallback}\n        </div>`;\n      }\n\n      // Build WHY/WHAT accordion if meaningful data is available\n      let whyWhatHtml = '';\n      if (op.why || op.what || (op.when_to_run && op.when_to_run.length > 0)) {\n        const hasWhen = Array.isArray(op.when_to_run) && op.when_to_run.length > 0;\n        const hasContext = !!op.why?.context;\n        const hasProblems = Array.isArray(op.why?.problems) && op.why!.problems.length > 0;\n        const hasOutcomes = Array.isArray(op.what?.outcomes) && op.what!.outcomes.length > 0;\n        const hasTimeline = !!op.what?.timeline;\n\n        // Only render the accordion if it will contain something useful.\n        const hasAnyDetails = hasWhen || hasContext || hasProblems || hasOutcomes || hasTimeline;\n\n        if (hasAnyDetails) {\n          const whenToRunHtml = hasWhen\n            ? `\n              <div class=\"operation-when\">\n                <h5>\uD83D\uDCC5 When to Run This</h5>\n                <ul>\n                  ${op.when_to_run!.map((when) => `<li>${escapeHtml(String(when))}</li>`).join('')}\n                </ul>\n              </div>\n            `\n            : '';\n\n          const contextHtml = hasContext\n            ? `<p class=\"operation-context\">${escapeHtml(String(op.why!.context))}</p>`\n            : '';\n\n          const problemsHtml = hasProblems\n            ? op.why!.problems\n                .map(\n                  (problem: any) =>\n                    `<li><strong>${escapeHtml(String(problem.symptom))}</strong><br>${escapeHtml(String(problem.description))}</li>`\n                )\n                .join('')\n            : '';\n\n          const outcomesHtml = hasOutcomes\n            ? op.what!.outcomes\n                .map((outcome: any) => {\n                  const icon =\n                    outcome.type === 'positive'\n                      ? '\u2705'\n                      : outcome.type === 'warning'\n                        ? '\u26A0\uFE0F'\n                        : outcome.type === 'temporary'\n                          ? '\u23F1\uFE0F'\n                          : '\u2139\uFE0F';\n                  return `<li>${icon} ${escapeHtml(String(outcome.description))}</li>`;\n                })\n                .join('')\n            : '';\n\n          const timelineHtml = hasTimeline\n            ? `<p class=\"operation-timeline\"><strong>\u23F1\uFE0F How Long:</strong> ${escapeHtml(String(op.what!.timeline))}</p>`\n            : '';\n\n          whyWhatHtml = `\n            <details class=\"operation-details\">\n              <summary>\u2139\uFE0F Why run this & What to expect</summary>\n              <div class=\"operation-details-content\">\n                ${whenToRunHtml}\n                ${contextHtml}\n                ${hasProblems ? `<div class=\"operation-why\"><h5>\uD83D\uDD0D Problems This Solves</h5><ul>${problemsHtml}</ul></div>` : ''}\n                ${hasOutcomes || hasTimeline ? `<div class=\"operation-what\"><h5>\u2728 What Happens After Running</h5>${hasOutcomes ? `<ul>${outcomesHtml}</ul>` : ''}${timelineHtml}</div>` : ''}\n              </div>\n            </details>\n          `;\n        }\n      }\n\n      return `\n        <div class=\"operation-item\" data-operation-id=\"${op.id}\">\n          <input type=\"checkbox\" id=\"op-${op.id}\" value=\"${op.id}\"\n                 ${op.recommended ? 'checked' : ''}>\n          <div class=\"operation-info\">\n            <h4>\n              ${op.name}\n              ${op.recommended ? '<span class=\"badge recommended\">Recommended</span>' : '<span class=\"badge optional\">Optional</span>'}\n            </h4>\n            <p>${op.description}</p>\n            ${whyWhatHtml}\n            ${lastRunHtml}\n          </div>\n        </div>\n      `;\n    }).join('');\n\n    const operationsDiv = document.getElementById('operations-list');\n    if (operationsDiv) {\n      operationsDiv.innerHTML = html;\n    }\n\n    const selectedCount = allOperations.filter(op => op.recommended).length;\n    showToast(`Loaded ${allOperations.length} operations (${selectedCount} recommended)`, 'success', 2000);\n\n    // Fetch and display global last maintenance run timestamp\n    try {\n      const lastRunResponse = await fetch('/api/maintenance/last-run');\n      const lastRunData = await lastRunResponse.json();\n\n      // Remove any existing info-banner to prevent duplicates\n      const existingBanners = document.querySelectorAll('.info-banner');\n      existingBanners.forEach(banner => banner.remove());\n\n      if (lastRunData.success && lastRunData.status === 'completed') {\n        const banner = document.createElement('div');\n        banner.className = 'info-banner';\n        banner.style.cssText = 'padding: 0.75rem; background: var(--success-bg); color: var(--success-color); border-radius: 6px; margin-bottom: 1rem; font-size: 0.875rem;';\n        const relative = lastRunData.global_last_run_relative || 'Recently';\n        banner.innerHTML = `\uD83D\uDCC5 Last maintenance run: <strong>${relative}</strong>`;\n        operationsDiv?.insertAdjacentElement('beforebegin', banner);\n      } else if (lastRunData.status === 'never') {\n        const banner = document.createElement('div');\n        banner.className = 'info-banner';\n        banner.style.cssText = 'padding: 0.75rem; background: var(--warning-bg); color: var(--warning-color); border-radius: 6px; margin-bottom: 1rem; font-size: 0.875rem;';\n        banner.innerHTML = `\u2139\uFE0F Maintenance has never been run`;\n        operationsDiv?.insertAdjacentElement('beforebegin', banner);\n      }\n    } catch (error) {\n      console.warn('Could not fetch last run info:', error);\n    }\n  } catch (error) {\n    console.error('Error loading operations:', error);\n    const operationsDiv = document.getElementById('operations-list');\n    if (operationsDiv) {\n      operationsDiv.innerHTML = `<div class=\"error\">Error loading operations: ${(error as Error).message}</div>`;\n    }\n    showToast('Failed to load operations', 'error');\n  }\n}\n\n// ============================================================================\n// Operation Selection & Templates\n// ============================================================================\n\n/**\n * Select all operations\n */\nexport function selectAllOperations(): void {\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#operations-list input[type=\"checkbox\"]');\n  checkboxes.forEach(cb => cb.checked = true);\n  showToast(`Selected all ${checkboxes.length} operations`, 'info', 2000);\n}\n\n/**\n * Deselect all operations\n */\nexport function deselectAllOperations(): void {\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#operations-list input[type=\"checkbox\"]');\n  checkboxes.forEach(cb => cb.checked = false);\n  showToast('Deselected all operations', 'info', 2000);\n}\n\n/**\n * Apply template selection\n */\nexport function applyTemplate(template: { name: string; operations: string[] }): void {\n  console.log('Applying template:', template);\n\n  // First, deselect all operations\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#operations-list input[type=\"checkbox\"]');\n  checkboxes.forEach(cb => cb.checked = false);\n\n  // Then select operations from the template\n  if (template.operations && template.operations.length > 0) {\n    let selectedCount = 0;\n    template.operations.forEach(opId => {\n      const checkbox = document.getElementById(`op-${opId}`) as HTMLInputElement | null;\n      if (checkbox) {\n        checkbox.checked = true;\n        selectedCount++;\n      } else {\n        console.warn(`Operation not found: ${opId}`);\n      }\n    });\n\n    showToast(`Applied \"${template.name}\" - ${selectedCount} operations selected`, 'success', 3000);\n  } else {\n    showToast(`Applied \"${template.name}\"`, 'info', 2000);\n  }\n}\n\n// ============================================================================\n// Run Operations\n// ============================================================================\n\n/**\n * Run selected maintenance operations\n */\nexport async function runSelectedOperations(): Promise<void> {\n  console.log('=== runSelectedOperations CALLED ===');\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#operations-list input[type=\"checkbox\"]:checked');\n  console.log('Found checked checkboxes:', checkboxes.length);\n  const selected = Array.from(checkboxes).map(cb => cb.value);\n  console.log('Selected operations:', selected);\n\n  // Store selected operations for historical ETA calculation\n  selectedOperationIds = selected;\n\n  if (selected.length === 0) {\n    console.log('No operations selected');\n    alert('No operations selected');\n    return;\n  }\n\n  // Increment invocation ID to track this specific run\n  operationInvocationId++;\n  const thisInvocationId = operationInvocationId;\n  console.log('Operation invocation ID:', thisInvocationId);\n\n  runningOperations = true;\n  const runBtn = document.getElementById('run-btn') as HTMLButtonElement | null;\n  if (runBtn) runBtn.disabled = true;\n\n  // Disable Select All/Deselect All buttons during operations\n  // UX Best Practice: Disable (don't hide) to maintain layout stability\n  // Research: Nielsen Norman Group, Material Design, Microsoft HIG\n  // Benefits: Prevents CLS (Cumulative Layout Shift), better accessibility, clear state communication\n  const selectAllBtn = document.getElementById('select-all-btn') as HTMLButtonElement | null;\n  const deselectAllBtn = document.getElementById('deselect-all-btn') as HTMLButtonElement | null;\n  if (selectAllBtn) {\n    selectAllBtn.disabled = true;\n    selectAllBtn.setAttribute('aria-disabled', 'true');\n    selectAllBtn.title = 'Selection locked while operations are running';\n  }\n  if (deselectAllBtn) {\n    deselectAllBtn.disabled = true;\n    deselectAllBtn.setAttribute('aria-disabled', 'true');\n    deselectAllBtn.title = 'Selection locked while operations are running';\n  }\n\n  // Show Skip/Cancel buttons\n  const skipBtn = document.getElementById('skip-btn') as HTMLElement | null;\n  const cancelBtn = document.getElementById('cancel-btn') as HTMLElement | null;\n  if (skipBtn) skipBtn.style.display = 'inline-block';\n  if (cancelBtn) cancelBtn.style.display = 'inline-block';\n  console.log('Showing Skip/Cancel buttons for invocation', thisInvocationId);\n\n  // Show progress container and initialize progress\n  const progressContainer = document.getElementById('progress-container');\n  if (progressContainer) progressContainer.style.display = 'block';\n  currentOperationIndex = 0;\n  totalOperations = selected.length;\n  operationTimes = [];\n  batchStartTime = Date.now();  // Track batch start time for elapsed metric\n  updateProgress();\n  startProgressTimer();\n  startQueueStatusPolling();\n\n  // Show and populate output area\n  const progressText = document.getElementById('progress-text') as HTMLElement | null;\n  if (progressText) {\n    progressText.style.display = 'block';\n    progressText.textContent = 'Connecting to server...\\n';\n    progressText.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n  }\n\n  try {\n    const response = await fetch('/api/maintenance/run', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        operation_ids: selected\n      })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to start operations');\n    }\n\n    // Handle Server-Sent Events stream\n    const reader = response.body?.getReader();\n    if (!reader) {\n      throw new Error('Failed to get response reader');\n    }\n\n    const decoder = new TextDecoder();\n    let buffer = '';\n\n    while (true) {\n      const { done, value } = await reader.read();\n\n      if (done) {\n        break;\n      }\n\n      // Decode and process SSE data\n      buffer += decoder.decode(value, { stream: true });\n      const lines = buffer.split('\\n');\n      buffer = lines.pop() || '';\n\n      for (const line of lines) {\n        if (line.startsWith('data: ')) {\n          const jsonData = line.slice(6);\n          try {\n            const event: OperationEvent = JSON.parse(jsonData);\n            handleOperationEvent(event);\n          } catch (e) {\n            console.error('Error parsing SSE data:', e);\n          }\n        }\n      }\n    }\n\n  } catch (error) {\n    if (progressText) {\n      progressText.textContent += `\\n\\nError: ${(error as Error).message}\\n`;\n    }\n    console.error('Error running operations:', error);\n  } finally {\n    // Only cleanup if this is still the current invocation\n    if (thisInvocationId === operationInvocationId) {\n      console.log('Cleaning up invocation', thisInvocationId, '(current)');\n      if (runBtn) runBtn.disabled = false;\n      if (skipBtn) skipBtn.style.display = 'none';\n      if (cancelBtn) cancelBtn.style.display = 'none';\n      runningOperations = false;\n\n      stopProgressTimer();\n      stopQueueStatusPolling();\n      batchStartTime = 0;  // Reset batch timer\n      if (progressContainer) progressContainer.style.display = 'none';\n\n      // Re-enable Select All/Deselect All buttons\n      if (selectAllBtn) {\n        selectAllBtn.disabled = false;\n        selectAllBtn.removeAttribute('aria-disabled');\n        selectAllBtn.title = '';\n      }\n      if (deselectAllBtn) {\n        deselectAllBtn.disabled = false;\n        deselectAllBtn.removeAttribute('aria-disabled');\n        deselectAllBtn.title = '';\n      }\n    } else {\n      console.log('Skipping cleanup for invocation', thisInvocationId, '(superseded by', operationInvocationId, ')');\n    }\n  }\n}\n\n/**\n * Skip the current operation\n */\nexport async function skipCurrentOperation(): Promise<void> {\n  // Skipping is often safe, but accidental clicks are costly/confusing.\n  // Use a lightweight confirmation to avoid surprise skips.\n  if (!confirm('Skip the current operation?')) {\n    return;\n  }\n\n  try {\n    const response = await fetch('/api/maintenance/skip', {\n      method: 'POST'\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const result = await response.json();\n\n    const progressText = document.getElementById('progress-text');\n    if (progressText) {\n      const message = result.message || 'Skipped by user';\n      progressText.textContent += `\\n\\n\u23ED\uFE0F ${message}\\n`;\n    }\n\n    showToast('Operation skipped', 'info', 2000);\n\n  } catch (error) {\n    console.error('Error skipping operation:', error);\n    alert('Error skipping operation: ' + (error as Error).message);\n  }\n}\n\n/**\n * Cancel all running operations\n */\nexport async function cancelOperations(): Promise<void> {\n  if (!confirm('Cancel all running operations?')) {\n    return;\n  }\n\n  try {\n    const response = await fetch('/api/maintenance/cancel', {\n      method: 'POST'\n    });\n\n    const result = await response.json();\n\n    const progressText = document.getElementById('progress-text');\n    if (progressText) {\n      progressText.textContent += `\\n\\n\u26A0\uFE0F ${result.message}\\n`;\n    }\n\n    // Hide buttons and increment invocation ID\n    operationInvocationId++;\n    runningOperations = false;\n    const runBtn = document.getElementById('run-btn') as HTMLButtonElement | null;\n    const skipBtn = document.getElementById('skip-btn') as HTMLElement | null;\n    const cancelBtn = document.getElementById('cancel-btn') as HTMLElement | null;\n    if (runBtn) runBtn.disabled = false;\n    if (skipBtn) skipBtn.style.display = 'none';\n    if (cancelBtn) cancelBtn.style.display = 'none';\n\n    stopProgressTimer();\n    stopQueueStatusPolling();\n    batchStartTime = 0;  // Reset batch timer\n    const progressContainer = document.getElementById('progress-container');\n    if (progressContainer) progressContainer.style.display = 'none';\n\n    const selectAllBtn = document.getElementById('select-all-btn') as HTMLButtonElement | null;\n    const deselectAllBtn = document.getElementById('deselect-all-btn') as HTMLButtonElement | null;\n    if (selectAllBtn) {\n      selectAllBtn.disabled = false;\n      selectAllBtn.removeAttribute('aria-disabled');\n      selectAllBtn.title = '';\n    }\n    if (deselectAllBtn) {\n      deselectAllBtn.disabled = false;\n      deselectAllBtn.removeAttribute('aria-disabled');\n      deselectAllBtn.title = '';\n    }\n\n    console.log('Operations cancelled, incremented invocation ID to', operationInvocationId);\n\n  } catch (error) {\n    console.error('Error cancelling operations:', error);\n    alert('Error cancelling operations: ' + (error as Error).message);\n  }\n}\n\n// ============================================================================\n// Event Handlers\n// ============================================================================\n\n/**\n * Handle operation event from SSE stream\n */\nexport function handleOperationEvent(event: OperationEvent): void {\n  const progressText = document.getElementById('progress-text');\n  if (!progressText) return;\n\n  switch (event.type) {\n    case 'start':\n      progressText.textContent += `\\n${event.message}\\n`;\n      progressText.textContent += `${'='.repeat(60)}\\n\\n`;\n\n      // Hide copy button when starting new operations\n      const inlineActionsStart = document.getElementById('inline-progress-actions');\n      if (inlineActionsStart) {\n        inlineActionsStart.style.display = 'none';\n        inlineActionsStart.innerHTML = '';\n      }\n\n      setTimeout(() => {\n        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });\n      }, 50);\n      break;\n\n    case 'operation_start':\n      progressText.textContent += `\\n[${event.progress}] Starting: ${event.operation_name}\\n`;\n      progressText.textContent += `${'-'.repeat(60)}\\n`;\n\n      operationStartTime = Date.now();\n      currentOperationId = event.operation_id || null;\n      currentOperationIndex++;\n      updateProgress();\n      break;\n\n    case 'output':\n      progressText.textContent += `${event.line}\\n`;\n      progressText.scrollTop = progressText.scrollHeight;\n      break;\n\n    case 'operation_complete':\n      const status = event.success ? '\u2713 Success' : '\u2717 Failed';\n      progressText.textContent += `\\n${status} (exit code: ${event.returncode})\\n`;\n\n      if (operationStartTime > 0 && currentOperationId) {\n        const durationMs = Date.now() - operationStartTime;\n        const durationSec = durationMs / 1000;\n\n        // Record to historical tracking (successful runs only for a cleaner median)\n        if (event.success) {\n          recordOperationTime(currentOperationId, durationSec);\n        }\n\n        // Also track for current batch average\n        operationTimes.push(durationMs);\n\n        updateProgress();\n      }\n      currentOperationId = null;\n      break;\n\n    case 'operation_skipped':\n      progressText.textContent += `\\n\u23ED\uFE0F  Skipped by user\\n`;\n      break;\n\n    case 'operation_error':\n      progressText.textContent += `\\nError: ${event.message}\\n`;\n      break;\n\n    case 'summary':\n      progressText.textContent += `\\n${'='.repeat(60)}\\n`;\n      progressText.textContent += `\\nSummary:\\n`;\n      progressText.textContent += `  Total operations: ${event.total}\\n`;\n      progressText.textContent += `  Successful: ${event.successful}\\n`;\n      progressText.textContent += `  Failed: ${event.failed}\\n`;\n      break;\n\n    case 'complete':\n      progressText.textContent += `\\n${event.message}\\n`;\n      progressText.textContent += `${'='.repeat(60)}\\n`;\n\n      refreshLastRunTimestamp();\n\n      // Add copy button\n      const inlineActions = document.getElementById('inline-progress-actions');\n      if (inlineActions) {\n        inlineActions.innerHTML = '';\n        inlineActions.style.display = 'flex';\n\n        const copyBtn = document.createElement('button');\n        copyBtn.className = 'primary';\n        copyBtn.id = 'copy-output-btn';\n        copyBtn.innerHTML = '\uD83D\uDCCB Copy Output to Clipboard';\n        copyBtn.onclick = () => copyOutputToClipboard();\n        inlineActions.appendChild(copyBtn);\n\n        setTimeout(() => {\n          copyBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n        }, 100);\n      }\n      break;\n\n    case 'cancelled':\n      progressText.textContent += `\\n${event.message}\\n`;\n      break;\n\n    case 'error':\n      progressText.textContent += `\\nError: ${event.message}\\n`;\n      break;\n  }\n\n  progressText.scrollTop = progressText.scrollHeight;\n}\n\n/**\n * Copy operation output to clipboard\n */\nexport async function copyOutputToClipboard(): Promise<void> {\n  const progressText = document.getElementById('progress-text');\n  const copyBtn = document.getElementById('copy-output-btn') as HTMLButtonElement | null;\n\n  if (!progressText || !copyBtn) return;\n\n  try {\n    await navigator.clipboard.writeText(progressText.textContent || '');\n\n    const originalText = copyBtn.innerHTML;\n    copyBtn.innerHTML = '\u2713 Copied to Clipboard!';\n    copyBtn.className = 'primary success-flash';\n\n    setTimeout(() => {\n      copyBtn.innerHTML = originalText;\n      copyBtn.className = 'primary';\n    }, 2000);\n\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error);\n\n    const originalText = copyBtn.innerHTML;\n    copyBtn.innerHTML = '\u2717 Copy Failed';\n    copyBtn.className = 'danger';\n\n    setTimeout(() => {\n      copyBtn.innerHTML = originalText;\n      copyBtn.className = 'primary';\n    }, 2000);\n  }\n}\n\n// ============================================================================\n// Progress Tracking\n// ============================================================================\n\n/**\n * Update elapsed time for entire batch\n */\nfunction updateElapsedTime(): void {\n  if (batchStartTime > 0) {\n    const elapsed = Date.now() - batchStartTime;\n    const elapsedEl = document.getElementById('total-elapsed');\n    if (elapsedEl) {\n      elapsedEl.textContent = formatDuration(elapsed / 1000);\n    }\n  }\n}\n\n/**\n * Start progress timer\n */\nexport function startProgressTimer(): void {\n  if (progressTimerInterval) {\n    clearInterval(progressTimerInterval);\n  }\n\n  progressTimerInterval = window.setInterval(() => {\n    // Update current operation timer\n    if (operationStartTime > 0) {\n      const elapsed = Date.now() - operationStartTime;\n      const timerEl = document.getElementById('current-op-timer');\n      if (timerEl) {\n        const currentDuration = formatDuration(elapsed / 1000);\n\n        // Show typical duration if available (server preferred; fallback to localStorage)\n        if (currentOperationId) {\n          const serverTypicalSec = operationStats?.[currentOperationId]?.typical_seconds;\n          const medianSec = typeof serverTypicalSec === 'number' ? serverTypicalSec : getMedianDuration(currentOperationId);\n\n          if (medianSec !== null && typeof medianSec === 'number' && !Number.isNaN(medianSec)) {\n            const typicalDuration = formatDuration(medianSec);\n            timerEl.textContent = `${currentDuration} / Typically ${typicalDuration}`;\n            timerEl.setAttribute('title', 'Typical runtime (median of recent runs)');\n          } else {\n            timerEl.textContent = `${currentDuration} / Typically \u2014`;\n            timerEl.setAttribute('title', 'No historical runtime yet (first run)');\n          }\n        } else {\n          timerEl.textContent = currentDuration;\n        }\n      }\n    }\n\n    // Update total elapsed time\n    updateElapsedTime();\n  }, 1000);\n}\n\n/**\n * Stop progress timer\n */\nexport function stopProgressTimer(): void {\n  if (progressTimerInterval) {\n    clearInterval(progressTimerInterval);\n    progressTimerInterval = null;\n  }\n}\n\n/**\n * Update progress display\n */\nexport function updateProgress(): void {\n  const percent = totalOperations > 0\n    ? Math.round((currentOperationIndex / totalOperations) * 100)\n    : 0;\n\n  console.log('updateProgress:', { currentOperationIndex, totalOperations, percent });\n\n  // Use unique IDs to avoid conflicts with progress-overlay modal\n  const progressBar = document.getElementById('maintenance-progress-bar') as HTMLElement | null;\n  const progressPercent = document.getElementById('maintenance-progress-percent');\n\n  if (progressBar) {\n    progressBar.style.width = percent + '%';\n    console.log('Set maintenance-progress-bar width to:', percent + '%');\n  } else {\n    console.error('maintenance-progress-bar element not found!');\n  }\n\n  if (progressPercent) {\n    progressPercent.textContent = percent + '%';\n    console.log('Set maintenance-progress-percent text to:', percent + '%');\n  } else {\n    console.error('maintenance-progress-percent element not found!');\n  }\n\n  const progressLabel = document.getElementById('progress-label');\n  if (progressLabel) {\n    progressLabel.textContent = `Operation ${currentOperationIndex} of ${totalOperations}`;\n  }\n\n  const opsProgress = document.getElementById('ops-progress');\n  if (opsProgress) {\n    opsProgress.textContent = `${currentOperationIndex}/${totalOperations}`;\n  }\n\n  // Calculate estimated remaining time using historical data\n  const estRemaining = document.getElementById('est-remaining');\n  if (estRemaining) {\n    if (currentOperationIndex >= totalOperations) {\n      estRemaining.textContent = 'Complete';\n    } else if (selectedOperationIds.length > 0) {\n      // Calculate remaining operations\n      const remainingOps = selectedOperationIds.slice(currentOperationIndex);\n\n      // Calculate progress of current operation (if any)\n      const currentProgress = currentOperationId && operationStartTime > 0\n        ? Math.min((Date.now() - operationStartTime) / (getAverageDuration(currentOperationId) * 1000), 0.99)\n        : 0;\n\n      // Use historical averages for accurate ETA\n      const etaSeconds = calculateETA(remainingOps, currentOperationId, currentProgress);\n      estRemaining.textContent = formatDuration(etaSeconds);\n    } else {\n      estRemaining.textContent = 'Calculating...';\n    }\n  }\n}\n\n/**\n * Start queue status polling\n */\nexport function startQueueStatusPolling(): void {\n  if (queueStatusInterval) {\n    clearInterval(queueStatusInterval);\n  }\n\n  queueStatusInterval = window.setInterval(async () => {\n    try {\n      const response = await fetch('/api/maintenance/queue');\n      const data = await response.json();\n\n      const queueDiv = document.getElementById('queue-status');\n      if (data.queued_count > 0) {\n        if (queueDiv) queueDiv.style.display = 'flex';\n        const queueCount = document.getElementById('queue-count');\n        if (queueCount) queueCount.textContent = String(data.queued_count);\n      } else {\n        if (queueDiv) queueDiv.style.display = 'none';\n      }\n\n      if (data.current_operation) {\n        console.log('Current operation:', data.current_operation);\n      }\n    } catch (error) {\n      console.error('Error polling queue status:', error);\n    }\n  }, 2000);\n}\n\n/**\n * Stop queue status polling\n */\nexport function stopQueueStatusPolling(): void {\n  if (queueStatusInterval) {\n    clearInterval(queueStatusInterval);\n    queueStatusInterval = null;\n  }\n}\n\n/**\n * Refresh last run timestamp after operations complete\n */\nasync function refreshLastRunTimestamp(): Promise<void> {\n  try {\n    const response = await fetch('/api/maintenance/last-run');\n    const data = await response.json();\n\n    // Update the global \"Last maintenance run\" banner (Task #130 fix)\n    const banners = document.querySelectorAll('.info-banner');\n    banners.forEach(banner => {\n      if (data.global_last_run_relative) {\n        banner.innerHTML = `\uD83D\uDCC5 Last maintenance run: <strong>${data.global_last_run_relative}</strong>`;\n        // Update style to success\n        (banner as HTMLElement).style.background = 'var(--success-bg)';\n        (banner as HTMLElement).style.color = 'var(--success-color)';\n      }\n    });\n\n    // Also update per-operation \"Last run\" timestamps in the operations list\n    if (data.operations) {\n      for (const [opId, opData] of Object.entries(data.operations)) {\n        const opItem = document.querySelector(`[data-operation-id=\"${opId}\"]`);\n        if (opItem) {\n          const lastRunDiv = opItem.querySelector('.operation-info > div:last-child');\n          if (lastRunDiv && (opData as any).last_run_relative) {\n            const statusIcon = (opData as any).success ? '\u2713' : '\u2717';\n            const statusColor = (opData as any).success ? 'var(--success-color)' : 'var(--error-color)';\n            const typicalDuration = (opData as any).typical_display || '';\n            const durationHtml = typicalDuration ? ` | \u23F1\uFE0F Typically <strong>${typicalDuration}</strong>` : '';\n            lastRunDiv.innerHTML = `\n              \uD83D\uDCC5 Last run: <strong>${(opData as any).last_run_relative}</strong> <span style=\"color: ${statusColor}\">${statusIcon}</span>${durationHtml}\n            `;\n          }\n        }\n      }\n    }\n  } catch (error) {\n    console.error('Error refreshing timestamp:', error);\n  }\n}\n\n// ============================================================================\n// Quick Start Wizard\n// ============================================================================\n\n// Research-based presets for Mac maintenance (2025-2026 best practices)\nconst WIZARD_PRESETS: Record<string, string[]> = {\n  // Quick Clean: Fast cleanup for weekly/biweekly use (5 min)\n  quick: ['browser-cache', 'trim-caches'],\n\n  // Weekly Routine: Comprehensive weekly maintenance (15 min)\n  weekly: ['brew-update', 'mas-update', 'disk-verify', 'browser-cache', 'trim-caches', 'trim-logs', 'spotlight-status'],\n\n  // Full Checkup: All recommended + comprehensive safe operations (30 min)\n  full: ['brew-update', 'mas-update', 'disk-verify', 'browser-cache', 'dev-cache', 'trim-caches', 'trim-logs', 'smart-check', 'spotlight-status', 'dns-flush']\n};\n\nexport function showQuickStartWizard(): void {\n  const modal = document.getElementById('wizard-modal');\n  if (modal) {\n    modal.classList.add('active');\n  }\n}\n\nexport function closeWizard(): void {\n  const modal = document.getElementById('wizard-modal');\n  if (modal) {\n    modal.classList.remove('active');\n  }\n}\n\nexport async function selectWizardOption(option: string): Promise<void> {\n  closeWizard();\n\n  if (option === 'custom') {\n    showToast('Select operations below', 'info', 2000);\n    return;\n  }\n\n  // Get operations for this preset\n  const operationsToRun = WIZARD_PRESETS[option] || [];\n\n  // Select the operations\n  document.querySelectorAll('#operations-list input[type=\"checkbox\"]').forEach((cb) => {\n    const checkbox = cb as HTMLInputElement;\n    checkbox.checked = operationsToRun.includes(checkbox.value);\n  });\n\n  // Show confirmation\n  const optionNames: Record<string, string> = {\n    quick: 'Quick Clean',\n    weekly: 'Weekly Routine',\n    full: 'Full Checkup'\n  };\n\n  showToast(`\u2728 Selected: ${optionNames[option]} (${operationsToRun.length} operations)`, 'success', 3000);\n\n  // Scroll to operations list\n  const operationsList = document.getElementById('operations-list');\n  if (operationsList) {\n    operationsList.scrollIntoView({ behavior: 'smooth' });\n  }\n\n  // Hide wizard prompt after first use\n  const wizardPrompt = document.getElementById('wizard-prompt');\n  if (wizardPrompt) {\n    wizardPrompt.style.display = 'none';\n  }\n}\n\n// ============================================================================\n// Keyboard Shortcuts\n// ============================================================================\n\nfunction isTypingInField(target: EventTarget | null): boolean {\n  const el = target as HTMLElement | null;\n  if (!el) return false;\n  const tag = (el.tagName || '').toLowerCase();\n  return tag === 'input' || tag === 'textarea' || tag === 'select' || el.isContentEditable;\n}\n\nexport async function runDoctor(): Promise<void> {\n  const panel = document.getElementById('doctor-panel');\n  const results = document.getElementById('doctor-results');\n  if (!panel || !results) return;\n\n  try {\n    const res = await fetch('/api/maintenance/doctor');\n    const data = await res.json();\n\n    if (!data.success) {\n      panel.style.display = 'block';\n      results.innerHTML = `<div style=\"color: var(--danger);\">Doctor check failed.</div>`;\n      return;\n    }\n\n    const issues: any[] = data.issues || [];\n    if (issues.length === 0) {\n      panel.style.display = 'none';\n      results.innerHTML = '';\n      return;\n    }\n\n    panel.style.display = 'block';\n\n    const rows = issues.map((i) => {\n      const severityColor = i.severity === 'error' ? 'var(--danger)' : (i.severity === 'warning' ? 'var(--warning)' : 'var(--text-secondary)');\n      const affects = Array.isArray(i.affects_operations) && i.affects_operations.length\n        ? `<div style=\"color: var(--text-secondary); font-size: 0.8rem; margin-top: 0.25rem;\">Affects: ${i.affects_operations.join(', ')}</div>`\n        : '';\n\n      const button = i.fix_action\n        ? `<button class=\"secondary\" style=\"white-space: nowrap;\" onclick=\"fixDoctorIssue('${i.fix_action}')\">${i.fix_label || 'Fix'}</button>`\n        : '';\n\n      return `\n        <div style=\"display:flex; justify-content: space-between; gap: 1rem; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 10px; background: var(--bg-secondary);\">\n          <div>\n            <div style=\"font-weight: 600; color: ${severityColor};\">${escapeHtml(i.title || 'Issue')}</div>\n            <div style=\"color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.15rem;\">${escapeHtml(i.detail || '')}</div>\n            ${affects}\n          </div>\n          <div style=\"display:flex; align-items:center; gap: 0.5rem;\">\n            ${button}\n          </div>\n        </div>\n      `;\n    }).join('');\n\n    results.innerHTML = `<div style=\"display:grid; gap: 0.75rem;\">${rows}</div>`;\n  } catch (e) {\n    panel.style.display = 'block';\n    results.innerHTML = `<div style=\"color: var(--danger);\">Doctor check failed.</div>`;\n  }\n}\n\n// Called from HTML via window.fixDoctorIssue\nexport async function fixDoctorIssue(action: string): Promise<void> {\n  try {\n    const res = await fetch('/api/maintenance/doctor/fix', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action })\n    });\n    const data = await res.json();\n    if (!res.ok || !data.success) {\n      throw new Error(data.detail || data.error || 'Failed');\n    }\n    showToast(data.message || 'Fix started', 'success', 4000);\n    // Re-check after a short delay\n    setTimeout(() => runDoctor().catch(() => {}), 1500);\n  } catch (e: any) {\n    showToast(e?.message || 'Fix failed', 'error', 5000);\n  }\n}\n\nexport function closeShortcuts(): void {\n  const modal = document.getElementById('shortcuts-modal');\n  if (modal) modal.classList.remove('active');\n}\n\nfunction openShortcuts(): void {\n  const modal = document.getElementById('shortcuts-modal');\n  if (modal) modal.classList.add('active');\n}\n\nexport function initKeyboardShortcuts(): void {\n  document.addEventListener('keydown', (e: KeyboardEvent) => {\n    // Don't trigger global shortcuts while typing\n    if (isTypingInField(e.target)) return;\n\n    // \"?\" opens shortcuts\n    if (e.key === '?' || (e.key === '/' && e.shiftKey)) {\n      e.preventDefault();\n      openShortcuts();\n      return;\n    }\n\n    // \"/\" focuses operation search\n    if (e.key === '/' && !e.metaKey && !e.ctrlKey && !e.altKey) {\n      const search = document.getElementById('operation-search') as HTMLInputElement | null;\n      if (search) {\n        e.preventDefault();\n        search.focus();\n      }\n      return;\n    }\n\n    // Escape closes modals\n    if (e.key === 'Escape') {\n      closeShortcuts();\n      closeWizard();\n      const closeScheduleModalFn = (window as any).closeScheduleModal as undefined | (() => void);\n      if (closeScheduleModalFn) closeScheduleModalFn();\n    }\n  });\n}\n\n", "/**\n * Storage module - Storage analysis and file management\n */\n\nimport type { StorageAnalyzeResponse } from '../types';\nimport { showToast, showProgressOverlay, updateProgressOverlay, hideProgressOverlay } from './ui';\nimport { escapeHtml } from './utils';\n\n// ============================================================================\n// Global State\n// ============================================================================\n\nexport const selectedFiles: Set<string> = new Set();\n\n// ============================================================================\n// Storage Analysis\n// ============================================================================\n\n/**\n * Analyze storage at specified path\n */\nexport async function analyzeStorage(): Promise<void> {\n  const pathInput = document.getElementById('path-input') as HTMLInputElement | null;\n  const path = pathInput?.value || '/Users';\n  const resultsDiv = document.getElementById('storage-results');\n  const analyzeBtn = document.getElementById('analyze-btn-text');\n\n  if (!resultsDiv || !analyzeBtn) return;\n\n  resultsDiv.innerHTML = '<div class=\"loading\"><div class=\"spinner\"></div> Analyzing storage...</div>';\n  analyzeBtn.innerHTML = '<div class=\"spinner\"></div>';\n  selectedFiles.clear();\n  updateBreadcrumbs(path);\n\n  try {\n    const response = await fetch(`/api/storage/analyze?path=${encodeURIComponent(path)}`);\n\n    if (!response.ok) {\n      let errorMsg = `Server error: ${response.status}`;\n      try {\n        const errorData = await response.json();\n        errorMsg = errorData.detail || errorMsg;\n      } catch {\n        // Response is not JSON\n      }\n      analyzeBtn.textContent = 'Analyze';\n      resultsDiv.innerHTML = `<div class=\"error\">${errorMsg}</div>`;\n      showToast(errorMsg, 'error');\n      return;\n    }\n\n    const data: StorageAnalyzeResponse = await response.json();\n    analyzeBtn.textContent = 'Analyze';\n\n    if (!data.success) {\n      const errorMsg = (data as any).error || 'Unknown error occurred';\n      resultsDiv.innerHTML = `<div class=\"error\">${errorMsg}</div>`;\n      showToast(errorMsg, 'error');\n      return;\n    }\n\n    showToast(`Analyzed: ${data.file_count} files, ${data.total_size_gb.toFixed(2)} GB`, 'success');\n\n    resultsDiv.innerHTML = `\n      <h3 style=\"margin-top: 2rem;\">Results for ${data.root_path}</h3>\n      <div class=\"metric-grid\" style=\"margin-top: 1rem;\">\n        <div class=\"metric-card\">\n          <h3>Total Size</h3>\n          <div class=\"value\">${data.total_size_gb.toFixed(2)} GB</div>\n        </div>\n        <div class=\"metric-card\">\n          <h3>Files</h3>\n          <div class=\"value\">${data.file_count.toLocaleString()}</div>\n        </div>\n        <div class=\"metric-card\">\n          <h3>Directories</h3>\n          <div class=\"value\">${data.dir_count.toLocaleString()}</div>\n        </div>\n      </div>\n      <h3 style=\"margin-top: 2rem;\">Largest Items</h3>\n      <p style=\"color: #6e6e73; margin-top: 0.5rem;\">Select items to delete</p>\n      <div class=\"file-list\">\n        ${data.largest_entries.map((entry, idx) => {\n          const displayName = entry.path.split('/').pop();\n          return `\n          <div class=\"file-item\">\n            <input type=\"checkbox\" id=\"file-${idx}\" data-path=\"${entry.path.replace(/\"/g, '&quot;').replace(/'/g, '&#39;')}\">\n            <div class=\"file-info\">\n              <strong>${displayName}</strong><br>\n              <small style=\"color: #6e6e73;\">${entry.path}</small>\n            </div>\n            <div class=\"file-size\">\n              <strong>${entry.size_gb.toFixed(2)} GB</strong><br>\n              <small style=\"color: #6e6e73;\">${entry.is_dir ? 'Directory' : 'File'}</small>\n            </div>\n          </div>\n        `;\n        }).join('')}\n      </div>\n      <div class=\"button-group\">\n        <button class=\"primary\" id=\"trash-btn\">\n          \uD83D\uDDD1\uFE0F Move to Trash (<span id=\"selected-count\">0</span>)\n        </button>\n        <button class=\"danger\" id=\"permanent-delete-btn\">\n          \u26A0\uFE0F Permanently Delete (<span id=\"selected-count-permanent\">0</span>)\n        </button>\n        <button class=\"secondary\" id=\"select-all-btn\">Select All</button>\n        <button class=\"secondary\" id=\"deselect-all-btn\">Deselect All</button>\n      </div>\n    `;\n\n    // Attach event listeners\n    console.log('=== ATTACHING EVENT LISTENERS ===');\n    const trashBtn = document.getElementById('trash-btn');\n    const permBtn = document.getElementById('permanent-delete-btn');\n    const selAllBtn = document.getElementById('select-all-btn');\n    const deselAllBtn = document.getElementById('deselect-all-btn');\n\n    console.log('Trash button found:', trashBtn);\n    console.log('Permanent button found:', permBtn);\n\n    if (trashBtn) {\n      trashBtn.addEventListener('click', () => {\n        console.log('TRASH BUTTON CLICKED!');\n        deleteSelected('trash');\n      });\n      console.log('\u2713 Trash button listener attached');\n    }\n\n    if (permBtn) {\n      permBtn.addEventListener('click', () => {\n        console.log('PERMANENT DELETE BUTTON CLICKED!');\n        deleteSelected('permanent');\n      });\n      console.log('\u2713 Permanent button listener attached');\n    }\n\n    if (selAllBtn) {\n      selAllBtn.addEventListener('click', selectAllFiles);\n      console.log('\u2713 Select all button listener attached');\n    }\n\n    if (deselAllBtn) {\n      deselAllBtn.addEventListener('click', deselectAllFiles);\n      console.log('\u2713 Deselect all button listener attached');\n    }\n\n    // Attach checkbox event listeners\n    const checkboxes = document.querySelectorAll<HTMLInputElement>('#storage-results input[type=\"checkbox\"]');\n    console.log('Found checkboxes:', checkboxes.length);\n    checkboxes.forEach((checkbox, idx) => {\n      checkbox.addEventListener('change', () => {\n        console.log(`Checkbox ${idx} changed, path:`, checkbox.dataset.path);\n        if (checkbox.dataset.path) {\n          toggleFileSelection(checkbox.dataset.path);\n        }\n      });\n    });\n    console.log('\u2713 All checkbox listeners attached');\n\n  } catch (error) {\n    const errorMsg = (error as Error).message || 'Failed to analyze storage';\n    resultsDiv.innerHTML = `<div class=\"error\">Error: ${errorMsg}</div>`;\n    analyzeBtn.textContent = 'Analyze';\n    showToast(errorMsg, 'error');\n  }\n}\n\n// ============================================================================\n// File Selection\n// ============================================================================\n\n/**\n * Toggle file selection\n */\nexport function toggleFileSelection(path: string): void {\n  console.log('toggleFileSelection called with:', path);\n  console.log('selectedFiles before:', Array.from(selectedFiles));\n  if (selectedFiles.has(path)) {\n    selectedFiles.delete(path);\n    console.log('Removed path');\n  } else {\n    selectedFiles.add(path);\n    console.log('Added path');\n  }\n  console.log('selectedFiles after:', Array.from(selectedFiles));\n  updateSelectedCount();\n}\n\n/**\n * Update selected file count display\n */\nexport function updateSelectedCount(): void {\n  const count = selectedFiles.size;\n  const countEl = document.getElementById('selected-count');\n  const countElPermanent = document.getElementById('selected-count-permanent');\n  if (countEl) countEl.textContent = String(count);\n  if (countElPermanent) countElPermanent.textContent = String(count);\n}\n\n/**\n * Select all files\n */\nexport function selectAllFiles(): void {\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#storage-results input[type=\"checkbox\"]');\n  checkboxes.forEach(cb => {\n    cb.checked = true;\n    if (cb.dataset.path) {\n      selectedFiles.add(cb.dataset.path);\n    }\n  });\n  updateSelectedCount();\n}\n\n/**\n * Deselect all files\n */\nexport function deselectAllFiles(): void {\n  const checkboxes = document.querySelectorAll<HTMLInputElement>('#storage-results input[type=\"checkbox\"]');\n  checkboxes.forEach(cb => {\n    cb.checked = false;\n  });\n  selectedFiles.clear();\n  updateSelectedCount();\n}\n\n// ============================================================================\n// File Deletion\n// ============================================================================\n\n/**\n * Delete selected files (move to trash or permanent)\n */\nexport async function deleteSelected(mode: 'trash' | 'permanent' = 'trash'): Promise<void> {\n  console.log('=== deleteSelected CALLED ===');\n  console.log('Mode:', mode);\n  console.log('selectedFiles.size:', selectedFiles.size);\n  console.log('selectedFiles contents:', Array.from(selectedFiles));\n\n  if (selectedFiles.size === 0) {\n    console.log('No files selected, showing toast');\n    showToast('No files selected', 'warning');\n    return;\n  }\n\n  // Different confirmation messages based on mode\n  let confirmMessage: string;\n  if (mode === 'permanent') {\n    confirmMessage = `\u26A0\uFE0F PERMANENTLY DELETE ${selectedFiles.size} item(s)?\\n\\n` +\n                    `This CANNOT be undone! Files will be deleted forever.\\n\\n` +\n                    `Consider using \"Move to Trash\" instead (recoverable).`;\n  } else {\n    confirmMessage = `Move ${selectedFiles.size} item(s) to Trash?\\n\\n` +\n                    `You can recover them from macOS Trash if needed.`;\n  }\n\n  console.log('Showing confirmation dialog');\n  const confirmed = confirm(confirmMessage);\n  console.log('User confirmed:', confirmed);\n\n  if (!confirmed) {\n    console.log('User cancelled');\n    return;\n  }\n\n  console.log('Proceeding with delete...');\n\n  const totalFiles = selectedFiles.size;\n  let deleted = 0;\n  let failed = 0;\n  const failedPaths: Array<{ path: string; error: string }> = [];\n  let operationCancelled = false;\n\n  // Disable both buttons\n  const trashBtn = document.getElementById('trash-btn') as HTMLButtonElement | null;\n  const permanentBtn = document.getElementById('permanent-delete-btn') as HTMLButtonElement | null;\n  if (trashBtn) trashBtn.disabled = true;\n  if (permanentBtn) permanentBtn.disabled = true;\n\n  // Show progress overlay\n  const actionTitle = mode === 'permanent' ? '\u26A0\uFE0F Permanently Deleting Files...' : '\uD83D\uDDD1\uFE0F Moving Files to Trash...';\n  showProgressOverlay(actionTitle, totalFiles, () => {\n    operationCancelled = true;\n  });\n\n  // Delete each file sequentially with progress updates\n  let current = 0;\n  for (const path of selectedFiles) {\n    if (operationCancelled) {\n      break;\n    }\n\n    current++;\n    const fileName = path.split('/').pop();\n    updateProgressOverlay(current, totalFiles, `Processing: ${fileName}`);\n\n    try {\n      const response = await fetch(`/api/storage/delete?path=${encodeURIComponent(path)}&mode=${mode}`, {\n        method: 'DELETE'\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ detail: 'Unknown error' }));\n        throw new Error(errorData.detail || `HTTP ${response.status}`);\n      }\n\n      const result = await response.json();\n\n      if (result.success) {\n        deleted++;\n      } else {\n        failed++;\n        failedPaths.push({ path, error: result.error || 'Unknown error' });\n        console.error(`Failed to ${mode === 'permanent' ? 'delete' : 'move to trash'} ${path}:`, result.error);\n      }\n    } catch (error) {\n      failed++;\n      failedPaths.push({ path, error: (error as Error).message });\n      console.error(`Error processing ${path}:`, error);\n    }\n  }\n\n  // Hide progress overlay\n  hideProgressOverlay();\n\n  // Re-enable buttons\n  if (trashBtn) trashBtn.disabled = false;\n  if (permanentBtn) permanentBtn.disabled = false;\n\n  // Clear selection\n  selectedFiles.clear();\n  updateSelectedCount();\n\n  // Show final results\n  const successVerb = mode === 'permanent' ? 'deleted' : 'moved to Trash';\n  const failedVerb = mode === 'permanent' ? 'delete' : 'move';\n\n  if (operationCancelled) {\n    showToast(`\u26A0\uFE0F Operation cancelled. Processed ${deleted + failed}/${totalFiles} items.`, 'warning', 4000);\n  } else if (deleted > 0 && failed === 0) {\n    showToast(`\u2705 Successfully ${successVerb} ${deleted} item(s)`, 'success', 4000);\n    if (mode === 'trash') {\n      showToast('\uD83D\uDCA1 Tip: You can recover files from macOS Trash', 'info', 3000);\n    }\n  } else if (deleted > 0 && failed > 0) {\n    showToast(`\u26A0\uFE0F ${successVerb.charAt(0).toUpperCase() + successVerb.slice(1)} ${deleted}, failed to ${failedVerb} ${failed} item(s)`, 'warning', 6000);\n    console.error('Failed operations:', failedPaths);\n  } else {\n    showToast(`\u274C Failed to ${failedVerb} all ${failed} item(s)`, 'error', 6000);\n    console.error('Failed operations:', failedPaths);\n  }\n\n  // Refresh storage view to verify actual filesystem state\n  showToast('Refreshing view...', 'info', 2000);\n  await analyzeStorage();\n}\n\n// ============================================================================\n// Path Navigation\n// ============================================================================\n\n/**\n * Update breadcrumbs navigation\n */\nexport function updateBreadcrumbs(path: string): void {\n  const breadcrumbsDiv = document.getElementById('breadcrumbs');\n  if (!breadcrumbsDiv) return;\n\n  const parts = path.split('/').filter(p => p);\n  if (parts.length === 0) {\n    breadcrumbsDiv.innerHTML = '<span class=\"breadcrumb\" onclick=\"setPath(\\'/\\')\">Root</span>';\n    return;\n  }\n\n  let html = '<span class=\"breadcrumb\" onclick=\"setPath(\\'/\\')\">\uD83C\uDFE0 Root</span>';\n  let currentPath = '';\n\n  parts.forEach((part, index) => {\n    currentPath += '/' + part;\n    const fullPath = currentPath;\n    html += ` <span class=\"breadcrumb-separator\">/</span> `;\n    html += `<span class=\"breadcrumb\" onclick=\"setPath('${fullPath}')\">${part}</span>`;\n  });\n\n  breadcrumbsDiv.innerHTML = html;\n}\n\n/**\n * Navigate to a specific path\n */\nexport function navigateToPath(path: string): void {\n  const pathInput = document.getElementById('path-input') as HTMLInputElement | null;\n  if (pathInput) {\n    pathInput.value = path;\n    updateBreadcrumbs(path);\n    showToast(`Path set to: ${path}`, 'info', 2000);\n  }\n}\n\n/**\n * Alias for navigateToPath (used by HTML onclick handlers)\n */\nexport function setPath(path: string): void {\n  navigateToPath(path);\n}\n\n/**\n * Get current username from stored system info\n */\nexport function getUsername(): string {\n  // Access global state from dashboard module\n  return (window as any)._currentUsername || 'username';\n}\n", "/**\n * Schedule module - Schedule management and automation\n */\n\nimport type { Schedule } from '../types';\nimport { showToast } from './ui';\nimport { escapeHtml } from './utils';\n\n// ============================================================================\n// Schedule Templates\n// ============================================================================\n\n/**\n * Load and display schedule templates\n */\nexport async function loadScheduleTemplates(): Promise<void> {\n  try {\n    console.log('Loading schedule templates...');\n    const response = await fetch('/api/schedules/templates');\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    console.log('Templates loaded:', data);\n\n    const container = document.getElementById('templates-list');\n    if (!container) return;\n\n    if (!data.templates || data.templates.length === 0) {\n      container.innerHTML = '<p style=\"color: var(--text-secondary);\">No templates available</p>';\n      return;\n    }\n\n    container.innerHTML = data.templates.map((template: any) => {\n      const templateJson = JSON.stringify(template).replace(/'/g, \"\\\\'\");\n      return `\n        <div class=\"template-card ${template.recommended ? 'recommended' : ''}\"\n             onclick='applyScheduleTemplate(${templateJson})'>\n          <div class=\"template-icon\">${template.icon}</div>\n          <div class=\"template-name\">${escapeHtml(template.name)}</div>\n          <div class=\"template-desc\">${escapeHtml(template.description)}</div>\n          ${template.recommended ? '<span class=\"template-badge\">RECOMMENDED</span>' : ''}\n        </div>\n      `;\n    }).join('');\n  } catch (error) {\n    console.error('Failed to load templates:', error);\n    const container = document.getElementById('templates-list');\n    if (container) {\n      container.innerHTML = `<p style=\"color: var(--danger);\">Error loading templates: ${(error as Error).message}</p>`;\n    }\n    showToast('Failed to load templates: ' + (error as Error).message, 'error');\n  }\n}\n\n// ============================================================================\n// Schedule Management\n// ============================================================================\n\n/**\n * Load and display schedules\n */\nexport async function loadSchedules(): Promise<void> {\n  try {\n    const response = await fetch('/api/schedules');\n    const data = await response.json();\n\n    const container = document.getElementById('schedules-list');\n    if (!container) return;\n\n    if (!data.success || !data.schedules || data.schedules.length === 0) {\n      container.innerHTML = `\n        <div style=\"text-align: center; padding: 3rem; color: var(--text-secondary);\">\n          <div style=\"font-size: 3rem; margin-bottom: 1rem;\">\uD83D\uDCC5</div>\n          <p>No schedules yet</p>\n          <p style=\"font-size: 0.875rem;\">Click \"New Schedule\" or use a template to get started</p>\n        </div>\n      `;\n      return;\n    }\n\n    container.innerHTML = data.schedules.map((schedule: Schedule) => {\n      const nextRun = schedule.next_run ? formatDateTime(schedule.next_run) : 'Not scheduled';\n      const lastRun = schedule.last_run ? formatDateTime(schedule.last_run) : 'Never';\n      const statusClass = schedule.enabled ? 'enabled' : 'disabled';\n      const statusText = schedule.enabled ? '\u25CF Enabled' : '\u25CB Disabled';\n\n      return `\n        <div class=\"schedule-card ${schedule.enabled ? '' : 'disabled'}\">\n          <div class=\"schedule-header\">\n            <div>\n              <div class=\"schedule-title\">${escapeHtml(schedule.name)}</div>\n              ${schedule.description ? `<div class=\"schedule-desc\">${escapeHtml(schedule.description)}</div>` : ''}\n            </div>\n            <div class=\"schedule-actions\">\n              <button class=\"secondary\" onclick=\"openScheduleModal('${schedule.id}')\" title=\"Edit\">\n                \u270F\uFE0F\n              </button>\n              <button class=\"secondary\" onclick=\"toggleScheduleEnabled('${schedule.id}', ${!schedule.enabled})\"\n                      title=\"${schedule.enabled ? 'Disable' : 'Enable'}\">\n                ${schedule.enabled ? '\u23F8\uFE0F' : '\u25B6\uFE0F'}\n              </button>\n              <button class=\"warning\" onclick=\"runScheduleNow('${schedule.id}')\" title=\"Run now\">\n                \u25B6\uFE0F Run\n              </button>\n              <button class=\"danger\" onclick=\"deleteSchedule('${schedule.id}')\" title=\"Delete schedule\">\n                \uD83D\uDDD1\uFE0F Delete\n              </button>\n            </div>\n          </div>\n          <div class=\"schedule-info\">\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Status</div>\n              <div class=\"schedule-info-value\">\n                <span class=\"schedule-status ${statusClass}\">${statusText}</span>\n              </div>\n            </div>\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Frequency</div>\n              <div class=\"schedule-info-value\">${formatFrequency(schedule)}</div>\n            </div>\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Time</div>\n              <div class=\"schedule-info-value\">${schedule.time_of_day}</div>\n            </div>\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Next Run</div>\n              <div class=\"schedule-info-value\">\n                <span class=\"next-run-badge\">\u23F0 ${nextRun}</span>\n              </div>\n            </div>\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Last Run</div>\n              <div class=\"schedule-info-value\">${lastRun}</div>\n            </div>\n            <div class=\"schedule-info-item\">\n              <div class=\"schedule-info-label\">Operations</div>\n              <div class=\"schedule-info-value\">${(schedule as any).operations?.length ?? (schedule as any).operation_ids?.length ?? 0} selected</div>\n            </div>\n          </div>\n          ${schedule.message ? `\n            <div class=\"conflict-warning\">\n              <div class=\"conflict-warning-text\">\u26A0\uFE0F ${escapeHtml(schedule.message)}</div>\n            </div>\n          ` : ''}\n        </div>\n      `;\n    }).join('');\n  } catch (error) {\n    console.error('Failed to load schedules:', error);\n    showToast('Failed to load schedules', 'error');\n  }\n}\n\n/**\n * Save a schedule (create or update)\n */\nexport async function saveSchedule(): Promise<void> {\n  const scheduleIdEl = document.getElementById('schedule-id') as HTMLInputElement | null;\n  const scheduleId = scheduleIdEl?.value || '';\n  const nameEl = document.getElementById('schedule-name') as HTMLInputElement | null;\n  const name = nameEl?.value || '';\n  const descEl = document.getElementById('schedule-description') as HTMLTextAreaElement | null;\n  const description = descEl?.value || '';\n  const freqEl = document.getElementById('schedule-frequency') as HTMLSelectElement | null;\n  const frequency = freqEl?.value || '';\n  const timeEl = document.getElementById('schedule-time') as HTMLInputElement | null;\n  const time = timeEl?.value || '';\n  const enabledEl = document.getElementById('schedule-enabled') as HTMLInputElement | null;\n  const enabled = enabledEl?.checked || false;\n  const notifyEl = document.getElementById('schedule-notify') as HTMLInputElement | null;\n  const notify = notifyEl?.checked ?? true;\n  const wakeEl = document.getElementById('schedule-wake') as HTMLInputElement | null;\n  const wake_mac = wakeEl?.checked ?? false;\n\n  // Get selected operations\n  const operations = Array.from(document.querySelectorAll<HTMLInputElement>('input[name=\"operations\"]:checked'))\n    .map(cb => cb.value);\n\n  if (!name || operations.length === 0 || !time) {\n    showToast('Please fill in all required fields', 'error');\n    return;\n  }\n\n  const scheduleData: any = {\n    name,\n    description,\n    operations,\n    frequency,\n    time_of_day: time + ':00', // Add seconds\n    enabled,\n    notify,\n    wake_mac\n  };\n\n  // Add frequency-specific fields\n  if (frequency === 'weekly') {\n    const days = Array.from(document.querySelectorAll<HTMLInputElement>('input[name=\"days\"]:checked'))\n      .map(cb => cb.value);\n    if (days.length === 0) {\n      showToast('Please select at least one day of the week', 'error');\n      return;\n    }\n    scheduleData.days_of_week = days;\n  } else if (frequency === 'monthly') {\n    const dayEl = document.getElementById('schedule-day') as HTMLInputElement | null;\n    const day = parseInt(dayEl?.value || '0');\n    if (!day || day < 1 || day > 28) {\n      showToast('Please enter a day between 1 and 28', 'error');\n      return;\n    }\n    scheduleData.day_of_month = day;\n  }\n\n  try {\n    const url = scheduleId ? `/api/schedules/${scheduleId}` : '/api/schedules';\n    const method = scheduleId ? 'PUT' : 'POST';\n\n    const response = await fetch(url, {\n      method,\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(scheduleData)\n    });\n\n    const data = await response.json();\n\n    if (!response.ok || !data.success) {\n      throw new Error(data.error || 'Failed to save schedule');\n    }\n\n    showToast(scheduleId ? 'Schedule updated!' : 'Schedule created!', 'success');\n    closeScheduleModal();\n    loadSchedules();\n  } catch (error) {\n    console.error('Failed to save schedule:', error);\n    showToast((error as Error).message, 'error');\n  }\n}\n\n/**\n * Delete a schedule\n */\nexport async function deleteSchedule(scheduleId: string): Promise<void> {\n  if (!confirm('Delete this schedule? This will unregister it from launchd.')) {\n    return;\n  }\n\n  try {\n    const response = await fetch(`/api/schedules/${scheduleId}`, {\n      method: 'DELETE'\n    });\n\n    const data = await response.json();\n\n    if (!response.ok || !data.success) {\n      throw new Error(data.error || 'Failed to delete schedule');\n    }\n\n    showToast('Schedule deleted', 'success');\n    loadSchedules();\n  } catch (error) {\n    console.error('Failed to delete schedule:', error);\n    showToast((error as Error).message, 'error');\n  }\n}\n\n/**\n * Toggle schedule enabled state\n */\nexport async function toggleScheduleEnabled(scheduleId: string, enabled: boolean): Promise<void> {\n  try {\n    const response = await fetch(`/api/schedules/${scheduleId}/enabled`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ enabled })\n    });\n\n    const data = await response.json();\n\n    if (!response.ok || !data.success) {\n      throw new Error(data.error || 'Failed to toggle schedule');\n    }\n\n    showToast(enabled ? 'Schedule enabled' : 'Schedule disabled', 'success');\n    loadSchedules();\n  } catch (error) {\n    console.error('Failed to toggle schedule:', error);\n    showToast((error as Error).message, 'error');\n  }\n}\n\n/**\n * Run schedule immediately\n */\nexport async function runScheduleNow(scheduleId: string): Promise<void> {\n  if (!confirm('Run this schedule now? This will execute all operations immediately.')) {\n    return;\n  }\n\n  try {\n    const response = await fetch(`/api/schedules/${scheduleId}/run-now`, {\n      method: 'POST'\n    });\n\n    const data = await response.json();\n\n    if (!response.ok || !data.success) {\n      throw new Error(data.message || 'Failed to run schedule');\n    }\n\n    showToast('Schedule running...', 'success');\n    // Reload to show updated last_run\n    setTimeout(() => loadSchedules(), 2000);\n    setTimeout(() => loadSchedules(), 7000);\n  } catch (error) {\n    console.error('Failed to run schedule:', error);\n    showToast((error as Error).message, 'error');\n  }\n}\n\n// ============================================================================\n// Schedule Modal\n// ============================================================================\n\n/**\n * Open schedule modal for create/edit\n */\nexport function openScheduleModal(scheduleId: string | null = null): Promise<void> {\n  const modal = document.getElementById('schedule-modal');\n  const title = document.getElementById('schedule-modal-title');\n  const form = document.getElementById('schedule-form') as HTMLFormElement | null;\n\n  if (!modal || !title) return Promise.resolve();\n\n  if (form) form.reset();\n  const scheduleIdEl = document.getElementById('schedule-id') as HTMLInputElement | null;\n  if (scheduleIdEl) scheduleIdEl.value = scheduleId || '';\n  title.textContent = scheduleId ? 'Edit Schedule' : 'Create Schedule';\n\n  // Load operations into selector\n  loadOperationsForSchedule();\n\n  if (scheduleId) {\n    return loadScheduleForEdit(scheduleId);\n  }\n\n  modal.classList.add('active');\n  return Promise.resolve();\n}\n\n/**\n * Close schedule modal\n */\nexport function closeScheduleModal(): void {\n  const modal = document.getElementById('schedule-modal');\n  if (modal) {\n    modal.classList.remove('active');\n  }\n}\n\n/**\n * Load operations for schedule selector\n */\nasync function loadOperationsForSchedule(): Promise<void> {\n  try {\n    const response = await fetch('/api/maintenance/operations');\n    const data = await response.json();\n\n    const container = document.getElementById('schedule-operations');\n    if (!container) return;\n\n    container.innerHTML = data.operations.map((op: any) => `\n      <label class=\"operation-checkbox\">\n        <input type=\"checkbox\" name=\"operations\" value=\"${op.id}\">\n        <div class=\"operation-checkbox-label\">\n          <div class=\"operation-checkbox-name\">${escapeHtml(op.name)}</div>\n          <div class=\"operation-checkbox-desc\">${escapeHtml(op.description || '')}</div>\n        </div>\n      </label>\n    `).join('');\n  } catch (error) {\n    console.error('Failed to load operations:', error);\n  }\n}\n\n/**\n * Load schedule data for editing\n */\nasync function loadScheduleForEdit(scheduleId: string): Promise<void> {\n  try {\n    const response = await fetch(`/api/schedules/${scheduleId}`);\n    const data = await response.json();\n\n    if (!data.success) {\n      showToast('Schedule not found', 'error');\n      closeScheduleModal();\n      return;\n    }\n\n    const schedule: Schedule = data.schedule;\n\n    const nameEl = document.getElementById('schedule-name') as HTMLInputElement | null;\n    const descEl = document.getElementById('schedule-description') as HTMLTextAreaElement | null;\n    const freqEl = document.getElementById('schedule-frequency') as HTMLSelectElement | null;\n    const timeEl = document.getElementById('schedule-time') as HTMLInputElement | null;\n    const enabledEl = document.getElementById('schedule-enabled') as HTMLInputElement | null;\n    const notifyEl = document.getElementById('schedule-notify') as HTMLInputElement | null;\n    const wakeEl = document.getElementById('schedule-wake') as HTMLInputElement | null;\n\n    if (nameEl) nameEl.value = schedule.name || '';\n    if (descEl) descEl.value = schedule.description || '';\n    if (freqEl && schedule.frequency) freqEl.value = schedule.frequency;\n    if (timeEl && schedule.time_of_day) timeEl.value = schedule.time_of_day.substring(0, 5); // HH:MM\n    if (enabledEl) enabledEl.checked = schedule.enabled;\n    if (notifyEl) notifyEl.checked = (schedule as any).notify ?? true;\n    if (wakeEl) wakeEl.checked = (schedule as any).wake_mac ?? false;\n\n    // Check selected operations\n    (schedule.operations || []).forEach((opId: string) => {\n      const checkbox = document.querySelector<HTMLInputElement>(`input[name=\"operations\"][value=\"${opId}\"]`);\n      if (checkbox) checkbox.checked = true;\n    });\n\n    // Set frequency-specific fields\n    updateFrequencyOptions();\n\n    if (schedule.frequency === 'weekly' && schedule.days_of_week) {\n      schedule.days_of_week.forEach(day => {\n        const checkbox = document.querySelector<HTMLInputElement>(`input[name=\"days\"][value=\"${day}\"]`);\n        if (checkbox) checkbox.checked = true;\n      });\n    }\n\n    if (schedule.frequency === 'monthly' && schedule.day_of_month) {\n      const dayEl = document.getElementById('schedule-day') as HTMLInputElement | null;\n      if (dayEl) dayEl.value = String(schedule.day_of_month);\n    }\n\n    const modal = document.getElementById('schedule-modal');\n    if (modal) modal.classList.add('active');\n  } catch (error) {\n    console.error('Failed to load schedule:', error);\n    showToast('Failed to load schedule', 'error');\n  }\n}\n\n/**\n * Update frequency-specific form options\n */\nexport function updateFrequencyOptions(): void {\n  const freqEl = document.getElementById('schedule-frequency') as HTMLSelectElement | null;\n  const frequency = freqEl?.value || '';\n  const daysSelector = document.getElementById('days-selector');\n  const daySelector = document.getElementById('day-selector');\n\n  if (daysSelector) {\n    daysSelector.style.display = frequency === 'weekly' ? 'block' : 'none';\n  }\n  if (daySelector) {\n    daySelector.style.display = frequency === 'monthly' ? 'block' : 'none';\n  }\n}\n\n/**\n * Apply template to schedule modal\n */\nexport function applyScheduleTemplate(template: any): void {\n  openScheduleModal();\n\n  // Wait for modal to open and operations to load\n  setTimeout(() => {\n    const nameEl = document.getElementById('schedule-name') as HTMLInputElement | null;\n    const descEl = document.getElementById('schedule-description') as HTMLTextAreaElement | null;\n    const freqEl = document.getElementById('schedule-frequency') as HTMLSelectElement | null;\n    const timeEl = document.getElementById('schedule-time') as HTMLInputElement | null;\n\n    if (nameEl) nameEl.value = template.name;\n    if (descEl) descEl.value = template.description;\n    if (freqEl) freqEl.value = template.frequency;\n    if (timeEl) timeEl.value = template.time_of_day.substring(0, 5);\n\n    // Check operations\n    template.operations.forEach((opId: string) => {\n      const checkbox = document.querySelector<HTMLInputElement>(`input[name=\"operations\"][value=\"${opId}\"]`);\n      if (checkbox) checkbox.checked = true;\n    });\n\n    // Set frequency options\n    updateFrequencyOptions();\n\n    if (template.days_of_week) {\n      template.days_of_week.forEach((day: string) => {\n        const checkbox = document.querySelector<HTMLInputElement>(`input[name=\"days\"][value=\"${day}\"]`);\n        if (checkbox) checkbox.checked = true;\n      });\n    }\n\n    if (template.day_of_month) {\n      const dayEl = document.getElementById('schedule-day') as HTMLInputElement | null;\n      if (dayEl) dayEl.value = template.day_of_month;\n    }\n  }, 100);\n}\n\n/**\n * Called when Schedule tab is shown\n */\nlet scheduleRefreshTimer: number | null = null;\n\nexport function onScheduleTabShow(): void {\n  loadScheduleTemplates();\n  loadSchedules();\n\n  // Keep schedule status (last_run/next_run) fresh while user is on the tab.\n  if (scheduleRefreshTimer) {\n    window.clearInterval(scheduleRefreshTimer);\n  }\n  scheduleRefreshTimer = window.setInterval(() => {\n    const tab = document.getElementById('schedule');\n    if (tab && tab.classList.contains('active')) {\n      loadSchedules();\n    }\n  }, 10000);\n}\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\n/**\n * Format schedule frequency\n */\nfunction formatFrequency(schedule: Schedule): string {\n  if (schedule.frequency === 'daily') {\n    return 'Daily';\n  } else if (schedule.frequency === 'weekly') {\n    const days = schedule.days_of_week?.map(d => d.substring(0, 3).toUpperCase()).join(', ');\n    return `Weekly (${days || 'No days'})`;\n  } else if (schedule.frequency === 'monthly') {\n    return `Monthly (Day ${schedule.day_of_month})`;\n  }\n  return schedule.frequency || 'Unknown';\n}\n\n/**\n * Format date/time for display\n */\nfunction formatDateTime(isoString: string): string {\n  try {\n    const date = new Date(isoString);\n    const now = new Date();\n    const diffMs = date.getTime() - now.getTime();\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n\n    if (diffMs < 0) {\n      return date.toLocaleString();\n    } else if (diffDays === 0 && diffHours < 24) {\n      return `in ${diffHours}h`;\n    } else if (diffDays < 7) {\n      return `in ${diffDays}d`;\n    } else {\n      return date.toLocaleDateString();\n    }\n  } catch (e) {\n    return isoString;\n  }\n}\n", "/**\n * Upkeep Tool - Frontend Application\n * Entry point for TypeScript modules\n */\n\nimport { initTheme, toggleTheme, switchTab, showToast, reloadScripts } from './modules/ui';\nimport { loadSystemInfo, loadHealthScore, loadTopProcesses } from './modules/dashboard';\nimport { loadOperations, runDoctor, fixDoctorIssue, runSelectedOperations, cancelOperations, skipCurrentOperation, applyTemplate, selectAllOperations, deselectAllOperations, copyOutputToClipboard, showQuickStartWizard, closeWizard, selectWizardOption, initKeyboardShortcuts, closeShortcuts } from './modules/maintenance';\nimport { analyzeStorage, setPath, getUsername } from './modules/storage';\nimport { onScheduleTabShow, openScheduleModal, closeScheduleModal, loadSchedules, saveSchedule, deleteSchedule, toggleScheduleEnabled, runScheduleNow, applyScheduleTemplate } from './modules/schedule';\nimport type { TabName } from './types';\n\nconsole.log('\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557');\nconsole.log('\u2551   UPKEEP - SCRIPT LOADING            \u2551');\nconsole.log('\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D');\n\n// ============================================================================\n// Global Functions - Expose to Window for onclick Handlers\n// ============================================================================\n\ndeclare global {\n  interface Window {\n    // Tab switching\n    switchTab: (tabName: TabName) => void;\n    showTab: (tabName: TabName) => void;\n\n    // Theme\n    toggleTheme: () => void;\n\n    // System Configuration\n    reloadScripts: () => Promise<void>;\n\n    // Dashboard\n    loadSystemInfo: () => Promise<void>;\n    loadHealthScore: () => Promise<void>;\n    loadTopProcesses: () => Promise<void>;\n\n    // Maintenance\n    loadOperations: () => Promise<void>;\n    runDoctor: () => Promise<void>;\n    fixDoctorIssue: (action: string) => Promise<void>;\n    runSelectedOperations: () => Promise<void>;\n    cancelOperations: () => void;\n    skipCurrentOperation: () => void;\n    applyTemplate: (template: { name: string; operations: string[] }) => void;\n    selectAllOperations: () => void;\n    deselectAllOperations: () => void;\n    copyOutputToClipboard: () => void;\n    showQuickStartWizard: () => void;\n    closeWizard: () => void;\n    selectWizardOption: (option: string) => Promise<void>;\n\n    // Keyboard shortcuts\n    closeShortcuts: () => void;\n\n    // Storage\n    analyzeStorage: () => Promise<void>;\n    setPath: (path: string) => void;\n    getUsername: () => string;\n\n    // Schedule\n    onScheduleTabShow: () => void;\n    openScheduleModal: (scheduleId?: string) => void;\n    closeScheduleModal: () => void;\n    loadSchedules: () => Promise<void>;\n    saveSchedule: () => Promise<void>;\n    deleteSchedule: (scheduleId: string) => void;\n    toggleScheduleEnabled: (scheduleId: string, enabled: boolean) => Promise<void>;\n    runScheduleNow: (scheduleId: string) => void;\n    applyScheduleTemplate: (template: any) => void;\n\n    // Utilities\n    showToast: (message: string, type?: 'success' | 'error' | 'warning' | 'info', duration?: number) => void;\n  }\n}\n\n// Expose functions to window\nwindow.switchTab = switchTab;\nwindow.showTab = switchTab; // Alias for compatibility\nwindow.toggleTheme = toggleTheme;\nwindow.reloadScripts = reloadScripts;\nwindow.loadSystemInfo = loadSystemInfo;\nwindow.loadHealthScore = loadHealthScore;\nwindow.loadTopProcesses = loadTopProcesses;\nwindow.loadOperations = loadOperations;\nwindow.runDoctor = runDoctor;\nwindow.fixDoctorIssue = fixDoctorIssue;\nwindow.runSelectedOperations = runSelectedOperations;\nwindow.cancelOperations = cancelOperations;\nwindow.skipCurrentOperation = skipCurrentOperation;\nwindow.applyTemplate = applyTemplate;\nwindow.selectAllOperations = selectAllOperations;\nwindow.deselectAllOperations = deselectAllOperations;\nwindow.copyOutputToClipboard = copyOutputToClipboard;\nwindow.showQuickStartWizard = showQuickStartWizard;\nwindow.closeWizard = closeWizard;\nwindow.selectWizardOption = selectWizardOption;\nwindow.closeShortcuts = closeShortcuts;\nwindow.analyzeStorage = analyzeStorage;\nwindow.setPath = setPath;\nwindow.getUsername = getUsername;\nwindow.onScheduleTabShow = onScheduleTabShow;\nwindow.openScheduleModal = openScheduleModal;\nwindow.closeScheduleModal = closeScheduleModal;\nwindow.loadSchedules = loadSchedules;\nwindow.saveSchedule = saveSchedule;\nwindow.deleteSchedule = deleteSchedule;\nwindow.toggleScheduleEnabled = toggleScheduleEnabled;\nwindow.runScheduleNow = runScheduleNow;\nwindow.applyScheduleTemplate = applyScheduleTemplate;\nwindow.showToast = showToast;\n\n// ============================================================================\n// Application Initialization\n// ============================================================================\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('\u2713 DOM Content Loaded');\n\n  // Keyboard shortcuts (\"?\" for help)\n  initKeyboardShortcuts();\n\n  // Initialize theme\n  initTheme();\n  console.log('\u2713 Theme initialized');\n\n  // Load initial dashboard data\n  loadSystemInfo();\n  loadHealthScore();\n  loadTopProcesses();\n  console.log('\u2713 Initial dashboard data loading');\n\n  // Set up periodic updates (every 5 seconds)\n  setInterval(() => {\n    // Only update if on dashboard tab\n    const dashboardTab = document.getElementById('dashboard');\n    if (dashboardTab && dashboardTab.classList.contains('active')) {\n      loadSystemInfo();\n      loadHealthScore();\n    }\n  }, 5000);\n  console.log('\u2713 Periodic updates configured (5s interval)');\n\n  // Set up top processes refresh (every 10 seconds)\n  setInterval(() => {\n    const dashboardTab = document.getElementById('dashboard');\n    if (dashboardTab && dashboardTab.classList.contains('active')) {\n      loadTopProcesses();\n    }\n  }, 10000);\n  console.log('\u2713 Process refresh configured (10s interval)');\n\n  console.log('\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557');\n  console.log('\u2551   UPKEEP - READY                     \u2551');\n  console.log('\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D');\n});\n"],
  "mappings": "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",
  "names": ["initTheme", "savedTheme", "applyTheme", "toggleTheme", "currentTheme", "newTheme", "theme", "actualTheme", "icon", "showToast", "message", "type", "duration", "toast", "container", "progressOverlayActive", "progressCancelCallback", "progressStartTime", "showProgressOverlay", "title", "total", "cancelCallback", "overlay", "titleEl", "percentEl", "currentEl", "barEl", "remainingEl", "handleProgressEscape", "updateProgressOverlay", "current", "message", "percent", "messageEl", "currentPercent", "animateValue", "elapsed", "rate", "eta", "minutes", "seconds", "hideProgressOverlay", "cancelProgress", "showToast", "e", "element", "start", "end", "duration", "decimals", "suffix", "startTime", "delta", "update", "currentTime", "progress", "easeProgress", "reloadScripts", "btn", "statusEl", "response", "error", "result", "errorMessage", "switchTab", "tabName", "tab", "tabContent", "loadSystemInfo", "loadOperations", "onScheduleTabShow", "previousMetrics", "currentUsername", "loadSystemInfo", "data", "cpuTrend", "calculateTrend", "memoryTrend", "diskTrend", "metricsDiv", "getTrendHTML", "getStatusClass", "memBar", "cpuValueEl", "memoryValueEl", "diskValueEl", "animateValue", "cpuBar", "memoryBar", "diskBar", "cpuCard", "memoryCard", "diskCard", "existingTrend", "valueDiv", "res", "sparkData", "drawSparkline", "err", "systemInfoDiv", "diskWarning", "memoryWarning", "loadLastMaintenanceRun", "error", "loadHealthScore", "healthDiv", "issuesHTML", "issue", "loadTopProcesses", "processesDiv", "html", "proc", "idx", "statusDiv", "lastRunText", "lastRun", "relative", "canvasId", "color", "canvas", "ctx", "width", "height", "min", "range", "value", "index", "x", "y", "history", "recent", "previous", "delta", "trend", "percent", "formatDuration", "seconds", "minutes", "secs", "hours", "escapeHtml", "str", "div", "STORAGE_KEY", "loadOperationTimes", "data", "STORAGE_KEY", "error", "saveOperationTimes", "times", "recordOperationTime", "operationId", "durationSeconds", "avg", "sum", "time", "getAverageDuration", "getMedianDuration", "sorted", "a", "b", "mid", "m", "getTypicalDurationDisplay", "median", "minutes", "seconds", "hours", "calculateETA", "remainingOperationIds", "currentOperationId", "currentOperationProgress", "eta", "opId", "avgDuration", "remainingProgress", "runningOperations", "operationInvocationId", "allOperations", "operationStartTime", "batchStartTime", "currentOperationIndex", "totalOperations", "operationTimes", "progressTimerInterval", "queueStatusInterval", "currentOperationId", "selectedOperationIds", "operationStats", "loadOperations", "cacheBuster", "data", "operationsDiv", "b", "operationsHistory", "error", "runDoctor", "html", "op", "opHistory", "typicalDuration", "getTypicalDurationDisplay", "durationHtml", "lastRunHtml", "statusIcon", "statusColor", "whyWhatHtml", "hasWhen", "hasContext", "hasProblems", "hasOutcomes", "hasTimeline", "whenToRunHtml", "when", "escapeHtml", "contextHtml", "problemsHtml", "problem", "outcomesHtml", "outcome", "timelineHtml", "selectedCount", "showToast", "lastRunData", "banner", "relative", "selectAllOperations", "checkboxes", "cb", "deselectAllOperations", "applyTemplate", "template", "opId", "checkbox", "runSelectedOperations", "selected", "thisInvocationId", "runBtn", "selectAllBtn", "deselectAllBtn", "skipBtn", "cancelBtn", "progressContainer", "updateProgress", "startProgressTimer", "startQueueStatusPolling", "progressText", "response", "reader", "decoder", "buffer", "done", "value", "lines", "line", "jsonData", "event", "handleOperationEvent", "e", "stopProgressTimer", "stopQueueStatusPolling", "skipCurrentOperation", "result", "message", "cancelOperations", "inlineActionsStart", "status", "durationMs", "durationSec", "recordOperationTime", "refreshLastRunTimestamp", "inlineActions", "copyBtn", "copyOutputToClipboard", "originalText", "updateElapsedTime", "elapsed", "elapsedEl", "formatDuration", "timerEl", "currentDuration", "serverTypicalSec", "medianSec", "getMedianDuration", "percent", "progressBar", "progressPercent", "progressLabel", "opsProgress", "estRemaining", "remainingOps", "currentProgress", "getAverageDuration", "etaSeconds", "calculateETA", "queueDiv", "queueCount", "opData", "opItem", "lastRunDiv", "WIZARD_PRESETS", "showQuickStartWizard", "modal", "closeWizard", "selectWizardOption", "option", "operationsToRun", "operationsList", "wizardPrompt", "isTypingInField", "target", "el", "tag", "panel", "results", "issues", "rows", "severityColor", "affects", "button", "fixDoctorIssue", "action", "res", "closeShortcuts", "openShortcuts", "initKeyboardShortcuts", "search", "closeScheduleModalFn", "selectedFiles", "analyzeStorage", "path", "resultsDiv", "analyzeBtn", "updateBreadcrumbs", "response", "errorMsg", "showToast", "data", "entry", "idx", "displayName", "trashBtn", "permBtn", "selAllBtn", "deselAllBtn", "deleteSelected", "selectAllFiles", "deselectAllFiles", "checkboxes", "checkbox", "toggleFileSelection", "error", "updateSelectedCount", "count", "countEl", "countElPermanent", "cb", "mode", "confirmMessage", "confirmed", "totalFiles", "deleted", "failed", "failedPaths", "operationCancelled", "permanentBtn", "showProgressOverlay", "current", "fileName", "updateProgressOverlay", "errorData", "result", "hideProgressOverlay", "successVerb", "failedVerb", "breadcrumbsDiv", "parts", "p", "html", "currentPath", "part", "index", "fullPath", "navigateToPath", "pathInput", "setPath", "getUsername", "loadScheduleTemplates", "response", "data", "container", "template", "templateJson", "escapeHtml", "error", "showToast", "loadSchedules", "schedule", "nextRun", "formatDateTime", "lastRun", "statusClass", "statusText", "formatFrequency", "saveSchedule", "scheduleId", "name", "description", "frequency", "time", "enabled", "notify", "wake_mac", "operations", "cb", "scheduleData", "days", "dayEl", "day", "url", "closeScheduleModal", "deleteSchedule", "toggleScheduleEnabled", "runScheduleNow", "openScheduleModal", "modal", "title", "form", "scheduleIdEl", "loadOperationsForSchedule", "loadScheduleForEdit", "op", "nameEl", "descEl", "freqEl", "timeEl", "enabledEl", "notifyEl", "wakeEl", "opId", "checkbox", "updateFrequencyOptions", "daysSelector", "daySelector", "applyScheduleTemplate", "scheduleRefreshTimer", "onScheduleTabShow", "tab", "d", "isoString", "date", "now", "diffMs", "diffDays", "diffHours", "switchTab", "toggleTheme", "reloadScripts", "loadSystemInfo", "loadHealthScore", "loadTopProcesses", "loadOperations", "runDoctor", "fixDoctorIssue", "runSelectedOperations", "cancelOperations", "skipCurrentOperation", "applyTemplate", "selectAllOperations", "deselectAllOperations", "copyOutputToClipboard", "showQuickStartWizard", "closeWizard", "selectWizardOption", "closeShortcuts", "analyzeStorage", "setPath", "getUsername", "onScheduleTabShow", "openScheduleModal", "closeScheduleModal", "loadSchedules", "saveSchedule", "deleteSchedule", "toggleScheduleEnabled", "runScheduleNow", "applyScheduleTemplate", "showToast", "initKeyboardShortcuts", "initTheme", "dashboardTab"]
}
